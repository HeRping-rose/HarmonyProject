# 6. ç•Œé¢æ¸²æŸ“

## 6.1.  æ¸²æŸ“-æ¡ä»¶æ¸²æŸ“

åœ¨ArkTSä¸­ æˆ‘ä»¬è¦æ ¹æ®æŸä¸ªçŠ¶æ€æ¥æ§åˆ¶å…ƒç´ æˆ–è€…ç»„ä»¶çš„æ˜¾ç¤ºéšè— å¯ä»¥é‡‡ç”¨æ¡ä»¶æ¸²æŸ“

- if/elseï¼ˆåˆ›å»ºé”€æ¯å…ƒç´ ï¼‰
- å…ƒç´ é«˜å®½-é€æ˜åº¦-ä½ç½®æ§åˆ¶ ï¼ˆå±æ€§æ§åˆ¶ï¼‰
- visibilityå±æ€§æ§åˆ¶

- ä½¿ç”¨if/else

é€šè¿‡ä¸€ä¸ªswitchå¼€å…³æ¥æ§åˆ¶å›¾ç‰‡çš„æ˜¾ç¤ºéšè—

![img](https://cdn.nlark.com/yuque/0/2024/gif/34522383/1715413458149-e3dcc8fa-6927-4075-889d-f2fd04840421.gif)

```typescript
@Entry
@ComponentV2
struct IsShow {
  @Local flag: boolean = false
  @Local isShow: boolean = false
  build() {
    Column() {
      Row() {
        Toggle({
          type: ToggleType.Switch,
          isOn: $$this.flag
        })

        // 1.æ§åˆ¶æ˜¯å¦æ¸²æŸ“
        if (this.flag) {
          Text('é£è¡Œæ¨¡å¼âœˆ')
        }
        else {
          Text('5Gå†²æµª...ğŸ„ğŸ»')
        }
      }

      // 2. æ§åˆ¶å®½é«˜/é€æ˜åº¦
      Column() {}
      .width(this.flag ? 300 : 0)
      .height(this.flag ? 300 : 0)
      .opacity(this.flag ? 1 : 0)
      .backgroundColor(Color.Orange)
      .animation({
        duration: 500
      })

      // 3. visibilityå±æ€§æ§åˆ¶
      Image($r('app.media.huawei'))
        .width(100)
        // éšè—ï¼ˆä¸æ˜¾ç¤ºä¹Ÿä¼šå ä½ç½®,ä¸å½±å“å…¶ä»–å…ƒç´ æ’åˆ—çš„è¯ä¼˜å…ˆä½¿ç”¨è¿™ä¸ªï¼Œæ€§èƒ½é«˜ï¼‰
        // Hidden éšè—ä¹Ÿä¼šå ä½ç½®, None éšè—ä¸å ä½ç½®, ç±»ä¼¼äº if çš„æ•ˆæœ
        .visibility(this.isShow ? Visibility.Visible : Visibility.Hidden)
      Button('åˆ‡æ¢æ˜¾ç¤º').onClick(() => {
        this.isShow = !this.isShow
      })
    }
    .width('100%')
  }
}
```

- å¤šç§æ¡ä»¶æ§åˆ¶

![img](https://cdn.nlark.com/yuque/0/2024/gif/34522383/1715416194598-7283233a-f43f-4cff-9768-ce222f1570c9.gif)

åˆ†æï¼š

1.é¡µé¢æ’ç‰ˆå¸ƒå±€æ ·å¼å®ç°

2.ä¸‹æ‹‰æ¡†çš„åŒå‘ç»‘å®š

3.æ¡ä»¶æ¸²æŸ“

```typescript
@Entry
@ComponentV2
struct ConditionCase02 {
  @Local myVip: number = 0;
  @Local optionValue:string = 'æš‚ä¸å¼€é€š'

  build() {
    Column({space:20}) {
      Row(){
        Text('å¼€é€šä¼šå‘˜:')
        Select([
          {value:'æš‚ä¸å¼€é€š'},
          {value:'VIP'},
          {value:'SVIP'}
        ])
          .width('50%')
          .selected($$this.myVip)
          .value($$this.optionValue)
          // .onSelect((index, value) => {
          //   this.myVip = index
          //   this.optionValue = value
          // })
      }

      Row({ space: 20 }) {
        Image($r('app.media.cat3')).width(30).borderRadius(30)
        Text('è¥¿åŒ—å´å½¦ç¥–')
        if (this.myVip === 0) {
          Text('VIP')
            .VIPStyle(this.myVip)
            .backgroundColor('#ccc')
        }
        else if (this.myVip === 1) {
          Text('VIP')
            .VIPStyle(this.myVip)
            .backgroundColor('#ffffb803')
        }
        else if (this.myVip === 2) {
          Text('SVIP')
            .VIPStyle(this.myVip)
            .backgroundColor('#ffb00909')
        }

      }.width('100%')
      .justifyContent(FlexAlign.Center)
    }
    .width('100%')
    .padding(20)
  }
}

@Extend(Text)
function VIPStyle(type: number) {
  .padding({
    left: 12,
    right: 12,
    bottom: 4,
    top: 4
  })
  .fontColor('#fff')
  .borderRadius(20)
  .fontSize(12)
}
```



## 6.2.  æ¸²æŸ“-å¾ªç¯æ¸²æŸ“

- ForEach-æœ€å¸¸ç”¨çš„
- LazyForEach-æ‡’åŠ è½½æ¸²æŸ“ï¼ˆå¤æ‚-åé¢è®²ï¼‰

å¾ªç¯æ¸²æŸ“ä½¿ç”¨ ForEachæ–¹æ³•æ¥è¿›è¡Œ

`ForEach` æ¥å£åŸºäºæ•°ç»„ç±»å‹æ•°æ®æ¥è¿›è¡Œå¾ªç¯æ¸²æŸ“ï¼Œéœ€è¦ä¸å®¹å™¨ç»„ä»¶é…åˆä½¿ç”¨ã€‚

```typescript
ForEach(
  // æ•°æ®æº
  arr: Array,
  // ç»„ä»¶ç”Ÿæˆå‡½æ•°
  itemGenerator: (item: å•é¡¹, index?: number) => void,
  // é”®å€¼ç”Ÿæˆå‡½æ•°
  keyGenerator?: (item: å•é¡¹, index?: number): string => string
)
```

![img](https://cdn.nlark.com/yuque/0/2025/png/21818800/1743931100041-43ecabd6-0057-49e6-b03a-e0f0f4e19d93.png)

- å®šä¹‰æ•°æ®ç±»å‹

```typescript
interface PayRecord {
  OrderName:string
  OrderDate:Date
  OrderAmount:number
}
@Entry
@ComponentV2
struct ForEachCase {
  PayRecordList: PayRecord[] = [
    {
      OrderName: 'ç»™è€å©†ä¹°å£çº¢',
      OrderDate: new Date('2024/05/11'),
      OrderAmount: 399.00
    },
    {
      OrderName: 'ç»™è€å©†ä¹°èŠ±',
      OrderDate: new Date('2024/05/12'),
      OrderAmount: 99.00
    },
    {
      OrderName: 'ç»™è‡ªå·±ä¹°æ‰‹æœº',
      OrderDate: new Date('2024/05/13'),
      OrderAmount: 9999.00
    }
  ]

  build() {
    Column() {
      // æ ‡é¢˜
      Row() {
        Text('æ”¯ä»˜è®°å½•')
          .layoutWeight(1)
          .textAlign(TextAlign.Center)
          .margin({
            left: 30
          })
      }
      .width('100%')
      .padding(16)
      .border({
        width: {
          bottom: 1
        },
        color: '#f4f5f6'
      })

      // åˆ—è¡¨
      Column() {
        // è¦å¾ªç¯çš„ç»“æ„ä½“
        Column({ space: 20 }) {
          Text('ç»™è€å©†ä¹°äº†ä¸€æœµèŠ±')
            .fontWeight(FontWeight.Bold)
            .width('100%')
          Row() {
            Text('ï¿¥43.00').fontColor(Color.Red)
            Text('2024/5/11')
          }
          .width('100%')
          .justifyContent(FlexAlign.SpaceBetween)
        }
        .width('100%')
        .padding(20)
      }
      .width('100%')
    }
    .width('100%')
    .height('100%')
  }
}
```

- åœ¨é¡µé¢ä¸­ç”Ÿæˆæ•°æ®ï¼Œç”¨ForEachå¾ªç¯

```typescript
ForEach(this.PayRecordList, (item: PayRecord) => {
  // è¦å¾ªç¯çš„ç»“æ„ä½“
  Column({ space: 20 }) {
    Text(item.OrderName)
      .fontWeight(FontWeight.Bold)
      .width('100%')
    Row() {
      Text(`ï¿¥${item.OrderAmount}`).fontColor(Color.Red)
      Text(item.OrderDate.toLocaleDateString())
    }
    .width('100%')
    .justifyContent(FlexAlign.SpaceBetween)
  }
  .width('100%')
  .padding(20)
})
```

![img](.\img\1709211381208-e0c45afb-3e08-4e9a-887e-6b818a006495.png)

- æ–°å»ºä¸€ä¸ªlistæ•°æ®ï¼Œè¿›è¡Œå¾ªç¯

ä½¿ç”¨ä¸‹é¢çš„æ¥å£

```typescript
interface GoodItem {
  goods_name: string
  goods_price: number
  goods_img: string
  goods_count: number
  id: number
}
```

- æ‹·è´å›¾ç‰‡åˆ° ets/assets



![img](.\img\1702037727233-a6890ee4-bbec-48f8-a71c-0b4041b83a78.png)

- å£°æ˜æ•°æ®

- å£°æ˜æ•°æ®

```typescript
list: GoodItem[] = [
    {
      "id": 1,
      "goods_name": "ç­ä¿BANQIAOè¶…ç«insæ½®å«è¡£å¥³å£«2020ç§‹å­£æ–°æ¬¾éŸ©ç‰ˆå®½æ¾æ…µæ‡’é£è–„æ¬¾å¤–å¥—å¸¦å¸½ä¸Šè¡£",
      "goods_img": "assets/1.webp",
      "goods_price": 108,
      "goods_count": 1,
    },
    {
      "id": 2,
      "goods_name": "å˜‰å¶å¸Œè¿å¸½å«è¡£å¥³æ˜¥ç§‹è–„æ¬¾2020æ–°æ¬¾å®½æ¾bféŸ©ç‰ˆå­—æ¯å°èŠ±ä¸­é•¿æ¬¾å¤–å¥—insæ½®",
      "goods_img": "assets/2.webp",
      "goods_price": 129,
      "goods_count": 1,
    },
    {
      "id": 3,
      "goods_name": "æ€èœœæ€¡2020ä¼‘é—²è¿åŠ¨å¥—è£…å¥³æ˜¥ç§‹å­£æ–°æ¬¾æ—¶å°šå¤§ç å®½æ¾é•¿è¢–å«è¡£ä¸¤ä»¶å¥—",
      "goods_img": "assets/3.webp",
      "goods_price": 198,
      "goods_count": 1,
    },
    {
      "id": 4,
      "goods_name": "æ€èœœæ€¡å«è¡£å¥³åŠ ç»’åŠ åš2020ç§‹å†¬è£…æ–°æ¬¾éŸ©ç‰ˆå®½æ¾ä¸Šè¡£è¿å¸½ä¸­é•¿æ¬¾å¤–å¥—",
      "goods_img": "assets/4.webp",
      "goods_price": 99,
      "goods_count": 1,
    },
    {
      "id": 5,
      "goods_name": "å¹‚å‡æ—©ç§‹å­£å«è¡£å¥³æ˜¥ç§‹è£…éŸ©ç‰ˆå®½æ¾ä¸­é•¿æ¬¾å‡ä¸¤ä»¶ä¸Šè¡£è–„æ¬¾insç›ç³»å¤–å¥—æ½®",
      "goods_img": "assets/5.webp",
      "goods_price": 156,
      "goods_count": 1,
    },
    {
      "id": 6,
      "goods_name": "ME&CITYå¥³è£…å†¬å­£æ–°æ¬¾é’ˆç»‡æŠ½ç»³ä¼‘é—²è¿å¸½å«è¡£å¥³",
      "goods_img": "assets/6.webp",
      "goods_price": 142.8,
      "goods_count": 1,
    },
    {
      "id": 7,
      "goods_name": "å¹‚å‡å‡ä¸¤ä»¶å¥³å£«å«è¡£ç§‹å†¬å¥³è£…2020å¹´æ–°æ¬¾éŸ©ç‰ˆå®½æ¾æ˜¥ç§‹å­£è–„æ¬¾insæ½®å¤–å¥—",
      "goods_img": "assets/7.webp",
      "goods_price": 219,
      "goods_count": 2,
    },
    {
      "id": 8,
      "goods_name": "ä¾é­…äºº2020ä¼‘é—²è¿åŠ¨è¡£å¥—è£…å¥³ç§‹å­£æ–°æ¬¾ç§‹å­£éŸ©ç‰ˆå®½æ¾å«è¡£ æ—¶å°šä¸¤ä»¶å¥—",
      "goods_img": "assets/8.webp",
      "goods_price": 178,
      "goods_count": 1,
    },
    {
      "id": 9,
      "goods_name": "èŠ·è‡»(zhizhen)åŠ åšå«è¡£2020æ˜¥ç§‹å­£å¥³é•¿è¢–éŸ©ç‰ˆå®½æ¾çŸ­æ¬¾åŠ ç»’æ˜¥ç§‹è£…è¿å¸½å¼€è¡«å¤–å¥—å†¬",
      "goods_img": "assets/9.webp",
      "goods_price": 128,
      "goods_count": 1,
    },
    {
      "id": 10,
      "goods_name": "Semiræ£®é©¬å«è¡£å¥³å†¬è£…2019æ–°æ¬¾å¯çˆ±ç”œç¾å¤§æ’è‰²å°æ¸…æ–°è¿å¸½è–„ç»’å¥³å£«å¥—å¤´è¡«",
      "goods_img": "assets/10.webp",
      "goods_price": 153,
      "goods_count": 1,
    }
  ]
```

ä½¿ç”¨ForEachéå†

```typescript
interface GoodItem {
  goods_name: string
  goods_price: number
  goods_img: string
  goods_count: number
  id: number
}


@Entry
@ComponentV2
struct ForEachGoodCase {
  list: GoodItem[] = [
    {
      "id": 1,
      "goods_name": "ç­ä¿BANQIAOè¶…ç«insæ½®å«è¡£å¥³å£«2020ç§‹å­£æ–°æ¬¾éŸ©ç‰ˆå®½æ¾æ…µæ‡’é£è–„æ¬¾å¤–å¥—å¸¦å¸½ä¸Šè¡£",
      "goods_img": "assets/1.webp",
      "goods_price": 108,
      "goods_count": 1,
    },
    {
      "id": 2,
      "goods_name": "å˜‰å¶å¸Œè¿å¸½å«è¡£å¥³æ˜¥ç§‹è–„æ¬¾2020æ–°æ¬¾å®½æ¾bféŸ©ç‰ˆå­—æ¯å°èŠ±ä¸­é•¿æ¬¾å¤–å¥—insæ½®",
      "goods_img": "assets/2.webp",
      "goods_price": 129,
      "goods_count": 1,
    },
    {
      "id": 3,
      "goods_name": "æ€èœœæ€¡2020ä¼‘é—²è¿åŠ¨å¥—è£…å¥³æ˜¥ç§‹å­£æ–°æ¬¾æ—¶å°šå¤§ç å®½æ¾é•¿è¢–å«è¡£ä¸¤ä»¶å¥—",
      "goods_img": "assets/3.webp",
      "goods_price": 198,
      "goods_count": 1,
    },
    {
      "id": 4,
      "goods_name": "æ€èœœæ€¡å«è¡£å¥³åŠ ç»’åŠ åš2020ç§‹å†¬è£…æ–°æ¬¾éŸ©ç‰ˆå®½æ¾ä¸Šè¡£è¿å¸½ä¸­é•¿æ¬¾å¤–å¥—",
      "goods_img": "assets/4.webp",
      "goods_price": 99,
      "goods_count": 1,
    },
    {
      "id": 5,
      "goods_name": "å¹‚å‡æ—©ç§‹å­£å«è¡£å¥³æ˜¥ç§‹è£…éŸ©ç‰ˆå®½æ¾ä¸­é•¿æ¬¾å‡ä¸¤ä»¶ä¸Šè¡£è–„æ¬¾insç›ç³»å¤–å¥—æ½®",
      "goods_img": "assets/5.webp",
      "goods_price": 156,
      "goods_count": 1,
    },
    {
      "id": 6,
      "goods_name": "ME&CITYå¥³è£…å†¬å­£æ–°æ¬¾é’ˆç»‡æŠ½ç»³ä¼‘é—²è¿å¸½å«è¡£å¥³",
      "goods_img": "assets/6.webp",
      "goods_price": 142.8,
      "goods_count": 1,
    },
    {
      "id": 7,
      "goods_name": "å¹‚å‡å‡ä¸¤ä»¶å¥³å£«å«è¡£ç§‹å†¬å¥³è£…2020å¹´æ–°æ¬¾éŸ©ç‰ˆå®½æ¾æ˜¥ç§‹å­£è–„æ¬¾insæ½®å¤–å¥—",
      "goods_img": "assets/7.webp",
      "goods_price": 219,
      "goods_count": 2,
    },
    {
      "id": 8,
      "goods_name": "ä¾é­…äºº2020ä¼‘é—²è¿åŠ¨è¡£å¥—è£…å¥³ç§‹å­£æ–°æ¬¾ç§‹å­£éŸ©ç‰ˆå®½æ¾å«è¡£ æ—¶å°šä¸¤ä»¶å¥—",
      "goods_img": "assets/8.webp",
      "goods_price": 178,
      "goods_count": 1,
    },
    {
      "id": 9,
      "goods_name": "èŠ·è‡»(zhizhen)åŠ åšå«è¡£2020æ˜¥ç§‹å­£å¥³é•¿è¢–éŸ©ç‰ˆå®½æ¾çŸ­æ¬¾åŠ ç»’æ˜¥ç§‹è£…è¿å¸½å¼€è¡«å¤–å¥—å†¬",
      "goods_img": "assets/9.webp",
      "goods_price": 128,
      "goods_count": 1,
    },
    {
      "id": 10,
      "goods_name": "Semiræ£®é©¬å«è¡£å¥³å†¬è£…2019æ–°æ¬¾å¯çˆ±ç”œç¾å¤§æ’è‰²å°æ¸…æ–°è¿å¸½è–„ç»’å¥³å£«å¥—å¤´è¡«",
      "goods_img": "assets/10.webp",
      "goods_price": 153,
      "goods_count": 1,
    }
  ]

  build() {
    List({ space: 20 }) {
      ForEach(this.list, (item: GoodItem) => {
        ListItem() {
          Row({ space: 10 }) {
            Image(item.goods_img)
              .borderRadius(8)
              .width(120)
              .height(200)
            Column() {
              Text(item.goods_name)
                .fontWeight(FontWeight.Bold)
              Text("Â¥ "+item.goods_price.toString())
                .fontColor(Color.Red)
                .fontWeight(FontWeight.Bold)
            }
            .padding({
              top: 5,
              bottom: 5
            })
            .alignItems(HorizontalAlign.Start)
            .justifyContent(FlexAlign.SpaceBetween)
            .height(200)
            .layoutWeight(1)
          }
          .width('100%')
        }
      })
    }
    .padding(20)
  }
}
```

## 6.3. keyçš„æ¨èå»ºè®®

ForEachçš„ç¬¬ä¸‰ä¸ªå±æ€§æ˜¯ä¸€ä¸ªå›è°ƒï¼Œå®ƒæ˜¯ç”Ÿæˆå”¯ä¸€keyçš„

ä¸ä¼ çš„è¯ä¼šå¸®åŠ©æˆ‘ä»¬ç”Ÿæˆç‹¬ä¸€æ— äºŒçš„key  =>   index_ + JSON.stringify(item)



é¸¿è’™æ›´æ–°çš„åŸç†ï¼šå¾ªç¯çš„æ¯”è¾ƒ-æ¯”è¾ƒä½ çš„keyå­˜åœ¨ä¸ï¼Œå¦‚æœå­˜åœ¨ç›¸åŒçš„keyï¼Œåˆ™ä¸æ›´æ–°

åªæ”¹åŠ¨äº†æŸä¸€æ¡æ•°æ®ï¼Œå¯èƒ½æ‰€æœ‰åˆ—è¡¨éƒ½ä¼šæ›´æ–°

ForEachçš„ç¬¬ä¸‰ä¸ªå‚æ•° å®å¯ä¸ç»™ ä¹Ÿä¸è¦çç»™

![img](https://cdn.nlark.com/yuque/0/2024/png/8435673/1706082377308-d6810258-dde4-4563-b6a2-bb6870800f06.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_28%2Ctext_6buR6ams56iL5bqP5ZGY%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10)

å¦‚æœæ•°ç»„ä¼šå‘ç”Ÿæ’å…¥ï¼Œåˆ é™¤çš„æ“ä½œï¼Œä¸è¦åŒ…å«indexä½œä¸ºkeyçš„å€¼ï¼Œ

ä¸ç»™keyæ¸²æŸ“ä¹Ÿæ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯å¯èƒ½ä¼šé€ æˆæ¸²æŸ“æ€§èƒ½é™ä½

- ä¸‹é¢æ˜¯keyçš„ä½¿ç”¨æ¡ˆä¾‹

```typescript
interface Person {
  id: number
  name: string
  age: number
}

@Entry
@ComponentV2
struct Parent {
  @Local heroList: Person[] = [
    { id: 1, name: 'å•å¸ƒ', age: 18 },
    { id: 2, name: 'å¼ é£', age: 20 },
    { id: 3, name: 'è²‚è‰', age: 21 }
  ]

  build() {
    Column() {
      Button() {
        Text('åœ¨ç¬¬1é¡¹åæ’å…¥æ–°é¡¹').fontSize(30)
      }
      .onClick(() => {
        // this.heroList.splice(1, 0, {
        //   id: Math.random(),
        //   name: 'å•è’™',
        //   age: 20
        // });
      })

      ForEach(this.heroList, (item: Person) => {
        ChildItem({ item: item })
      })
    }
    .justifyContent(FlexAlign.Center)
    .width('100%')
    .height('100%')
    .backgroundColor(0xF1F3F5)
  }
}



@ComponentV2
struct ChildItem {
  @Param item: Person = {} as Person;
  aboutToAppear(): void {
    console.log('æˆ‘è¢«æ¸²æŸ“äº†', this.item.name)
  }
  build() {
    Text(this.item.name + this.item.age)
      .fontSize(30)
  }
}
```

ä¼šå‘ç°ä½¿ç”¨indexä½œä¸ºkeyï¼Œä¸€æ—¦ä¸­é—´é¡¹å˜åŒ–ï¼Œåé¢çš„æ‰€æœ‰é¡¹ï¼Œéƒ½éœ€è¦é‡æ–°æ¸²æŸ“æ›´æ–°ï¼Œå½±å“æ€§èƒ½

è½¬è€Œä¿®æ”¹æˆä»¥ id ä½œä¸º keyï¼Œæµ‹è¯•å‘ç°æ€§èƒ½æå‡ä¸å°‘ï¼Œåªæœ‰å¯¹åº”é¡¹éœ€è¦æ›´æ–°

```typescript
interface Hero {
  id: number
  name: string
  age: number
}

@Entry
@ComponentV2
struct Parent {
  @Local heroList: Hero[] = [
    { id: 1, name: 'å•å¸ƒ', age: 18 },
    { id: 2, name: 'å¼ é£', age: 20 },
    { id: 3, name: 'è²‚è‰', age: 21 },
  ]

  build() {
    Column() {
      Button() {
        Text('åœ¨ç¬¬1é¡¹åæ’å…¥æ–°é¡¹').fontSize(30)
      }
      .onClick(() => {
        this.heroList.splice(1, 0, {
          id: Math.random(),
          name: 'å•è’™',
          age: 20
        });
      })

      ForEach(this.heroList, (item: Hero) => {
        ChildItem({ item: item })
      }, (item: Hero) => item.id.toString())
    }
    .justifyContent(FlexAlign.Center)
    .width('100%')
    .height('100%')
    .backgroundColor(0xF1F3F5)
  }
}



@ComponentV2
struct ChildItem {
  @Param item: Hero = {} as Hero;
  aboutToAppear(): void {
    console.log('æˆ‘è¢«æ¸²æŸ“äº†', this.item.name)
  }
  build() {
    Text(this.item.name + this.item.age)
      .fontSize(30)
  }
}
```







## 6.4. æ¸²æŸ“-ä¸‹æ‹‰åˆ·æ–°+ä¸Šæ‹‰åŠ è½½

ä¸‹æ‹‰åˆ·æ–°

![img](https://cdn.nlark.com/yuque/0/2024/gif/34522383/1718255001802-d22d6c98-760d-48c9-84a2-44a788eb032f.gif)

Refreshç»„ä»¶æ”¯æŒä¸‹æ‹‰åˆ·æ–°ï¼ŒåŒ…è£¹Listç»„ä»¶ï¼Œä¸‹æ‹‰äº‹ä»¶ä¸­æ›´æ–°åˆ—è¡¨

åŸºç¡€ç»“æ„ï¼š

```typescript
@Entry
@ComponentV2
struct RefreshCase {
  @Local list: number[] = Array(20).fill(Date.now())

  build() {
    Column() {
      List() {
        ForEach(this.list, (item: number) => {
          ListItem() {
            Row() {
              Text(item.toString())
            }.width('100%').padding(20).border({
              width: {
                bottom: 1
              },
              color: Color.Gray,
            })
          }
        })
      }
    }
    .height('100%')
    .width('100%')
  }
}
```

æ·»åŠ Refreshç»„ä»¶ï¼š

```typescript
@Entry
@ComponentV2
struct RefreshCase {
  @Local list: number[] = Array(20).fill(Date.now())
  @Local refreshing: boolean = false

  @Builder
  refreshContent() {
    Text('æ­£åœ¨åŠ è½½ä¸­...')
      .width('100%')
      .textAlign(TextAlign.Center)
  }

  build() {
    Column() {
      Refresh({ refreshing: $$this.refreshing, builder: this.refreshContent }) {
        List() {
          ForEach(this.list, (item: number) => {
            ListItem() {
              Row() {
                Text(item.toString())
              }.width('100%').padding(20).border({
                width: {
                  bottom: 1
                },
                color: Color.Gray,
              })
            }
          })
        }

      }.onRefreshing(() => {
        setTimeout(() => {
          this.list = Array(20).fill(Date.now())
          this.refreshing = false
        }, 1000)
      })
    }
    .height('100%')
    .width('100%')
  }
}
```

ä¸Šæ‹‰åŠ è½½

![img](https://cdn.nlark.com/yuque/0/2024/gif/34522383/1718255051768-7522f2ec-074f-44db-8a65-42d8a132ecf2.gif)

æ»šåŠ¨è‡³åˆ—è¡¨å°¾éƒ¨(ä¼šç«‹åˆ»è§¦å‘ä¸¤æ¬¡ï¼Œæ»šåŠ¨åˆ°åº•éƒ¨+å›å¼¹ä¸€ä¸‹)

```typescript
import { promptAction } from '@kit.ArkUI'

@Entry
@ComponentV2
struct RefreshCase {
  @Local list: number[] = Array(20).fill(Date.now())
  @Local refreshing: boolean = false
  @Local isLoading: boolean = false // æ ‡è®°æ˜¯å¦æ­£åœ¨åŠ è½½ä¸­
  scroller: Scroller = new Scroller()

  @Builder
  refreshContent() {
    Text('æ­£åœ¨åŠ è½½ä¸­...')
      .width('100%')
      .textAlign(TextAlign.Center)
  }
  build() {
    Column() {
      Refresh({
        refreshing: $$this.refreshing,
        builder: this.refreshContent
      }) {
        List({ scroller: this.scroller }) {
          ForEach(this.list, (item: number) => {
            ListItem() {
              Row() {
                Text(item.toString())
              }.width('100%').padding(20).border({
                width: {
                  bottom: 1
                },
                color: Color.Gray,
              })
            }
          })
          if (this.isLoading) {
            ListItem() {
              Text('æ­£åœ¨æ‹¼å‘½åŠ è½½ä¸­...')
                .width('100%')
                .textAlign(TextAlign.Center)
                .height(80)
            }
          }
        }
        .onReachEnd(() => {
          if (!this.isLoading) {
            this.isLoading = true // å¼€å§‹åŠ è½½, æ˜¾ç¤ºLoadingåŠ¨ç”»
            this.scroller.scrollEdge(Edge.End)

            setTimeout(() => {
              this.list.push(...Array(10).fill(Date.now()))
              promptAction.showToast({
                message: '10æ¡æ•°æ®æ·»åŠ æˆåŠŸ'
              })
              this.isLoading = false
            }, 2000)
          }
        })
      }
      .onRefreshing(() => {
        setTimeout(() => {
          this.list = Array(20).fill(Date.now())
          this.refreshing = false
        }, 1000)
      })
    }
    .height('100%')
    .width('100%')
  }
}
```

# 

# 7. çŸ¥ä¹æ¡ˆä¾‹

![img](.\img\1701338675957-762313a8-7fa1-455f-9891-3897ae1795d9.png)

## 7.1. æ‹†è§£ç»„ä»¶

- æ–°å»ºZhiHuçš„æ–‡ä»¶å¤¹ï¼Œæ–°å»ºpage
- æ–°å»ºcomponents, é‡Œé¢æ–°å»º HmNavBarå’ŒHmCommentItem

![img](https://cdn.nlark.com/yuque/0/2025/png/21818800/1743922549747-45e95ae0-2660-4764-bdec-3482058f7d90.png)

```typescript
@Preview
@ComponentV2
struct HmNavBar {
  title: string = "æ ‡é¢˜"
  build() {
    Row() {
      // è¿”å›é”®
      Row() {
        Image($r('sys.media.ohos_ic_public_arrow_left'))
          .width(16)
          .height(16)
      }
      .width(30)
      .height(30)
      .borderRadius(15)
      .backgroundColor("#f4f4f4")
      .justifyContent(FlexAlign.Center)
      .margin({
        left: 20
      })
      Text(this.title)
        .layoutWeight(1)
        .textAlign(TextAlign.Center)
        .margin({
          right: 50
        })
    }
    .width('100%')
    .height(50)
    .border({
      color: "#f4f5f6",
      width: {
        bottom: 1
      }
    })
  }
}
export { HmNavBar }
```

- **HmCommentItem**

![img](https://cdn.nlark.com/yuque/0/2025/png/21818800/1743922520869-7c925698-6998-4370-8fcb-82ab7d7d1760.png)

```typescript
@Preview
@ComponentV2
struct HmCommentItem {
  build() {
    Row({ space: 10 }) {
      Image("https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe-img.xhscdn.com%2Fbw1%2F1bad8264-7428-44cf-a92d-3016a2de537b%3FimageView2%2F2%2Fw%2F1080%2Fformat%2Fjpg&refer=http%3A%2F%2Fsafe-img.xhscdn.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1711626934&t=5478cb3adef5d3e29e6952934797ca39")
        .width(40)
        .height(40)
        .borderRadius(20)

      Column({ space: 10 }) {
        Text("å‘¨æ°ä¼¦")
          .fontColor("#303a43")
          .fontSize(18)
          .fontWeight(FontWeight.Bold)

        Text("é»„æ²³æ±Ÿæœ€è¿‘ä¸€ä»£éƒ½å¸¦è“ç‰™ï¼Œæ„å¤§åˆ©æ‹Œé¢å¿…é¡»ä½¿ç”¨42ğŸ‘Œé’¢ç­‹æ··å‡åœŸé‡å­åŠ›å­¦")
          .fontColor("#2f3642")
          .lineHeight(22)
        Row() {
          Text("10-21 .IPå±åœ°åŒ—äº¬")
            .fontColor("#cacaca")
            .fontSize(12)

          Row({ space: 4 }) {
            Image($r("app.media.ic_like"))
              .width(12)
              .height(12)
              .fillColor("#cacaca")

            Text("100")
              .fontColor("#cacaca")
              .fontSize(12)

          }
        }
        .justifyContent(FlexAlign.SpaceBetween)
        .width('100%')
      }
      .alignItems(HorizontalAlign.Start)
      .layoutWeight(1)

    }
    .alignItems(VerticalAlign.Top)
    .padding(20)
    .width('100%')
  }
}
export { HmCommentItem }
```

- åœ¨components/index.etsç»Ÿä¸€å¯¼å‡º

```typescript
export * from './HmCommentItem'
export * from './HmNavBar'
```

- åœ¨ZhiHU/ZHihu.etsä¸­ä½¿ç”¨

```typescript
import { HmCommentItem, HmNavBar } from './components'

@Entry
@ComponentV2
struct ZhiHu {
  build() {
   Column() {
     HmNavBar({ title: 'è¯„è®ºå›å¤'  })
     HmCommentItem()
     Divider().strokeWidth(6)
     Row() {
       Text("è¯„è®ºæ•°50")
     }
     .width('100%')
     .height(50)
     .padding({
       left: 20
     })
     .border({
       color: '#f3f4f5',
       width: {
         bottom: 1
       }
     })
     ForEach([1,2,3,4,5,6], () => {
       HmCommentItem()
     })
   }
  }
}
```

![img](.\img\1709215387268-1215329b-2ece-4014-9582-0d65ac932892.png)



éœ€è¦å‡ºç°æ»šåŠ¨åŒºåŸŸã€‚

ä½¿ç”¨äº†Listç»„ä»¶ï¼Œå­ç»„ä»¶å¿…é¡»æœ‰ListItem/ListItemGroup

```typescript
 List() {
   ForEach([1,2,3,4,5,6], () => {
     ListItem() {
       HmCommentItem()
     }
   })
 }.layoutWeight(1)
```

![img](.\img\1709361733764-fa0c8989-feff-42da-bbee-654ce199cf4e.png)

## 7.2. è¯„è®ºåˆ—è¡¨ - @Param çˆ¶ä¼ å­

åœ¨ZhiHu/models/index.etsä¸‹å»ºç«‹å¦‚ä¸‹ç±»å‹

- å®šä¹‰ä¸€ä¸ªè¯„è®ºçš„interface

```typescript
export interface ReplyItem {
  avatar: ResourceStr // å¤´åƒ
  author: string   // ä½œè€…
  id: number  // è¯„è®ºçš„id
  content: string // è¯„è®ºå†…å®¹
  time: string // å‘è¡¨æ—¶é—´
  area: string // åœ°åŒº
  likeNum: number // ç‚¹èµæ•°é‡
  likeFlag: boolean | null // å½“å‰ç”¨æˆ·æ˜¯å¦ç‚¹è¿‡èµ
}

export class ReplyItemModel implements ReplyItem {
  id: number = 0
  avatar: string | Resource = ''
  author: string = ''
  content: string = ''
  time: string = ''
  area: string = ''
  likeNum: number = 0
  likeFlag: boolean | null = null

  constructor(model: ReplyItem) {
    this.id = model.id
    this.avatar = model.avatar
    this.author = model.author
    this.content = model.content
    this.time = model.time
    this.area = model.area
    this.likeNum = model.likeNum
    this.likeFlag = model.likeFlag
  }
}
```

- å®šä¹‰ä¸€ä¸ªè¯„è®ºåˆ—è¡¨æ•°æ®- åœ¨Entryç»„ä»¶ä¸­

å› ä¸ºæˆ‘ä»¬éœ€è¦çš„æ˜¯classå¯¹è±¡ï¼Œæ‰€ä»¥æ¯ä¸ªå¯¹è±¡éƒ½éœ€è¦newä¸€ä¸‹

```typescript
@Local commentList: ReplyItemModel[] = [
  new ReplyItemModel({
    id: 1,
    avatar: 'https://picx.zhimg.com/027729d02bdf060e24973c3726fea9da_l.jpg?source=06d4cd63',
    author: 'åæ‰§ç‹‚-å¦„æƒ³å®¶',
    content: 'æ›´ä½•å†µè¿˜åˆ†åˆ°ä¸€ä¸ªæ‘©æ´›å“¥[æƒŠå–œ]',
    time: '11-30',
    area: 'æµ·å—',
    likeNum: 34,
    likeFlag: false
  }) ,
  new ReplyItemModel({
    id: 2,
    avatar: 'https://pic1.zhimg.com/v2-5a3f5190369ae59c12bee33abfe0c5cc_xl.jpg?source=32738c0c',
    author: 'William',
    content: 'å½“å¹´å¸Œè…Šå¯æ˜¯æŠŠ1ï¼š0å‘æŒ¥åˆ°æè‡´äº†',
    time: '11-29',
    area: 'åŒ—äº¬',
    likeNum: 58,
    likeFlag: false
  }),
  new ReplyItemModel({
    id: 3,
    avatar: 'https://picx.zhimg.com/v2-e6f4605c16e4378572a96dad7eaaf2b0_l.jpg?source=06d4cd63',
    author: 'Andy Garcia',
    content: 'æ¬§æ´²æ¯å…¶å®16é˜Ÿçƒé˜Ÿæ‰“æ­£èµ›å·²ç»å·®ä¸å¤šï¼Œ24é˜Ÿæ‰“æ­£èµ›æ„å‘³ç€æ­£èµ›é˜¶æ®µåœ¨å°ç»„èµ›ä¸€æ ·æœ‰å¼±é˜Ÿã€‚',
    time: '11-28',
    area: 'ä¸Šæµ·',
    likeNum: 10,
    likeFlag: false
  }),
  new ReplyItemModel({
    id: 4,
    avatar: 'https://picx.zhimg.com/v2-53e7cf84228e26f419d924c2bf8d5d70_l.jpg?source=06d4cd63',
    author: 'æ­£å®—å¥½é±¼å¤´',
    content: 'ç¡®å®çœ¼çº¢å•Šï¼Œäºšæ´²å°±æ²¡è¿™ç§çƒé˜Ÿï¼Œè®©ä¸­å›½é˜Ÿåˆ·',
    time: '11-27',
    area: 'é¦™æ¸¯',
    likeNum: 139,
    likeFlag: false
  }),
  new ReplyItemModel({
    id: 5,
    avatar: 'https://pic1.zhimg.com/v2-eeddfaae049df2a407ff37540894c8ce_l.jpg?source=06d4cd63',
    author: 'æŸ±å­å“¥',
    content: 'æˆ‘æ˜¯æ”¯æŒæ‰©å¤§çš„ï¼Œäºšæ´²æ¯æ¬§æ´²æ¯æ‰©åˆ°32é˜Ÿï¼Œä¸–ç•Œæ¯æ‰©åˆ°64é˜Ÿæ‰æ˜¯å¥½çš„ï¼Œä¸–ç•Œä¸Šæœ‰è¶…è¿‡200æ”¯é˜Ÿä¼ï¼Œæ¬§æ´²åŒº55æ”¯é˜Ÿä¼ï¼Œäºšæ´²åŒº47æ”¯é˜Ÿä¼ï¼Œå³ä½¿å¦‚æ­¤ä¹Ÿå°±å…­æˆå‡ºç°ç‡',
    time: '11-27',
    area: 'æ—§é‡‘å±±',
    likeNum: 29,
    likeFlag: false
  }),
  new ReplyItemModel({
    id: 6,
    avatar: 'https://picx.zhimg.com/v2-fab3da929232ae911e92bf8137d11f3a_l.jpg?source=06d4cd63',
    author: 'é£è½©é€¸',
    content: 'ç¦æ­¢æ¬§æ´²æ¯æ‰©å†›ä¹‹å‰ï¼Œåº”è¯¥å…ˆç¦æ­¢ä¸–ç•Œæ¯æ‰©å†›ï¼Œæˆ–è€…è‡³å°‘æŠŠäºšæ´²åé¢ä¸€åŠç»™æ¬§æ´²ã€‚',
    time: '11-26',
    area: 'é‡Œçº¦',
    likeNum: 100,
    likeFlag: false
  })
]
```

- åœ¨ä¸»é¡µä¸­æ¸²æŸ“

```typescript
 List() {
   ForEach(this.commentList, (item: ReplyItemModel) => {
     ListItem() {
       HmCommentItem({ item })
     }
   })
 }.layoutWeight(1)
```

- CommentItemç»„ä»¶æ¥æ”¶ä¼ å…¥æ•°æ®

```typescript
import { ReplyItem, ReplyItemModel } from '../models'

@ComponentV2
struct HmCommentItem {
  // æ¥æ”¶æ¸²æŸ“çš„é€‰é¡¹
  @Param item: ReplyItemModel = new ReplyItemModel({} as ReplyItem) // åˆå§‹å€¼ åªæ˜¯ä¸ºäº†è¯­æ³•ä¸æŠ¥é”™

  build() {
    Row({ space: 10 }) {
      Image(this.item.avatar)
        .width(40)
        .height(40)
        .borderRadius(20)

      Column({ space: 10 }) {
        Text(this.item.author)
          .fontColor("#303a43")
          .fontSize(18)
          .fontWeight(FontWeight.Bold)

        Text(this.item.content)
          .fontColor("#2f3642")
          .lineHeight(22)
        Row() {
          Text(`${this.item.time} .IPå±åœ°${this.item.area}`)
            .fontColor("#cacaca")
            .fontSize(12)

          Row({ space: 4 }) {
            Image($r("app.media.ic_public_like"))
              .width(12)
              .height(12)
              .fillColor("#cacaca")

            Text(this.item.likeNum.toString())
              .fontColor("#cacaca")
              .fontSize(12)

          }
        }
        .justifyContent(FlexAlign.SpaceBetween)
        .width('100%')
      }
      .alignItems(HorizontalAlign.Start)
      .layoutWeight(1)

    }
    .alignItems(VerticalAlign.Top)
    .padding(20)
    .width('100%')
  }
}
export { HmCommentItem }
```

- é¡¶éƒ¨ç»„ä»¶åŒæ ·éœ€è¦new å¯¹è±¡ä¼ å…¥è¿‡å»

```typescript
HmCommentItem({
  item: new ReplyItemModel({
    id: 999,
    author: 'å‘¨æ°ä¼¦',
    avatar: $r("app.media.dog"),
    likeNum: 10,
    likeFlag: false,
    time: '03-02',
    area: 'åŒ—äº¬',
    content: 'äººåˆ°äº†ä¸€å®šçš„å¹´é¾„æ–°é™ˆä»£è°¢å°±æ…¢äº†ï¼Œåƒäº†èƒ–ä¸åƒç˜¦äº†çš±çº¹å°±å¤šï¼Œè¦é é”»ç‚¼ '
  })
})
```





![img](.\img\1709363881259-5c5ef31e-c8ce-4c08-a42c-8490fd03f13a.png)





## 7.3.  åº•éƒ¨å›å¤æŒ‰é’®

![img](https://cdn.nlark.com/yuque/0/2025/png/21818800/1743925729304-07524546-e5ad-49df-8f55-555067f54cc6.png)

å°è£…åº•éƒ¨çš„å›å¤ç»„ä»¶

Zhihu/components/HmReplyInput.ets

```typescript
@ComponentV2
struct HmReplyInput {
  @Local content: string = ""
  build() {
    Row({ space: 10 }) {
      TextInput({ text: $$this.content, placeholder: 'ï½è¯·ç•™ä¸‹æ‚¨çš„ç¥è¯„è®º' })
        .layoutWeight(1)
        .height(40)
      Button("å‘å¸ƒ")
    }
    .padding({ left: 10, right: 10 })
    .width('100%')
    .height(60)
  }
}
export { HmReplyInput }
```

- components/index.ets

```typescript
export * from './HmReplyInput'
```

- ç»„ä»¶åœ¨ä¸»é¡µä¸­ä½¿ç”¨

```typescript
 List() {
   ForEach(this.commentList, (item: ReplyItemModel) => {
     ListItem() {
       HmCommentItem({ item })
     }
   })
 }.layoutWeight(1)
 HmReplyInput()  // åœ¨æ­¤åˆ»æ˜¾ç¤º
```



## 7.4. å®ç°ç‚¹èµ - @Event å­ä¼ çˆ¶

å­ç»„ä»¶å¦‚ä½•è°ƒç”¨çˆ¶ç»„ä»¶çš„å‡½æ•°

- å­ç»„ä»¶è¦å£°æ˜ä¸€ä¸ªå‡½æ•°

```typescript
@Event test: () => void = () => {}  // test:å˜é‡ç±»å‹ = åˆå§‹å€¼

å­é‡Œé¢ï¼Œå¯ä»¥è°ƒç”¨ this.test()
```

- çˆ¶ç»„ä»¶éœ€è¦ç»™å­ç»„ä»¶ä¼ å…¥è¿™ä¸ªå‚æ•°

```typescript
Child({
  test: () => {
    this.fatherFn()
  }
})
```



- å®ç°ç‚¹èµ

```typescript
@Event changeLike: () => void = () => {}
```

- æ³¨å†Œç‚¹å‡»äº‹ä»¶

```typescript
Row({ space: 4 }) {
  Image($r("app.media.ic_like"))
    .width(12)
    .height(12)
    .fillColor(this.item.likeFlag ? Color.Red : "#cacaca")

  Text(this.item.likeNum?.toString())
    .fontColor(this.item.likeFlag ? Color.Red :"#cacaca")
    .fontSize(12)
}
.onClick(() => {
  this.changeLike()
})
```

- çˆ¶ç»„ä»¶å®šä¹‰å‡½æ•°ï¼Œä¼ å…¥å‡½æ•°

```typescript
changeLike (item: ReplyItemModel) {
  // éœ€è¦æ‹¿åˆ°ç‚¹å‡»çš„æ•°æ® æ‹¿åˆ°æ•°æ®æ›´æ–°æ•°æ®å³å¯
  if(item.likeFlag) {
    // ç‚¹è¿‡èµ
    item.likeNum--
  }
  else {
    // æ²¡æœ‰ç‚¹è¿‡èµ
    item.likeNum++
  }
  item.likeFlag = !item.likeFlag // å–å
}
```

- ä¼ å…¥å­ç»„ä»¶

```typescript
List() {
 ForEach(this.commentList, (item: ReplyItemModel) => {
   ListItem() {
     HmCommentItem({
       item,
       changeLike: () => {
         this.changeLike(item)
       }
     })
   }
 })
}.layoutWeight(1)
```

- æ·»åŠ  `@ObervedV2`
-  å’Œ  `@Trace`è£…é¥°

```typescript
export interface ReplyItem {
  avatar: ResourceStr // å¤´åƒ
  author: string   // ä½œè€…
  id: number  // è¯„è®ºçš„id
  content: string // è¯„è®ºå†…å®¹
  time: string // å‘è¡¨æ—¶é—´
  area: string // åœ°åŒº
  likeNum: number // ç‚¹èµæ•°é‡
  likeFlag: boolean | null // å½“å‰ç”¨æˆ·æ˜¯å¦ç‚¹è¿‡èµ
}

@ObservedV2
export class ReplyItemModel implements ReplyItem {
  id: number = 0
  avatar: string | Resource = ''
  author: string = ''
  content: string = ''
  time: string = ''
  area: string = ''
  @Trace likeNum: number = 0
  @Trace likeFlag: boolean | null = null

  constructor(model: ReplyItem) {
    this.id = model.id
    this.avatar = model.avatar
    this.author = model.author
    this.content = model.content
    this.time = model.time
    this.area = model.area
    this.likeNum = model.likeNum
    this.likeFlag = model.likeFlag
  }
}
```

![img](.\img\1709367491842-74d10e73-55cb-4cb0-a985-72eadbeafc12.png)

## 7.5. é¡¶éƒ¨çš„ç‚¹èµ

- å°†é¡¶éƒ¨çš„æ•°æ®æŠ½æå‡ºæ¥

```typescript
@Local showTop: boolean = true
@Local topItem: ReplyItemModel = new ReplyItemModel({
  id: 999,
  author: 'å‘¨æ°ä¼¦',
  avatar: $r("app.media.dog"),
  likeNum: 10,
  likeFlag: false,
  time: '03-02',
  area: 'åŒ—äº¬',
  content: 'äººåˆ°äº†ä¸€å®šçš„å¹´é¾„æ–°é™ˆä»£è°¢å°±æ…¢äº†ï¼Œåƒäº†èƒ–ä¸åƒç˜¦äº†çš±çº¹å°±å¤šï¼Œè¦é é”»ç‚¼'
})
```

- èµ‹å€¼

```typescript
HmCommentItem({
  item: this.topItem,
  changeLike: () => {
    this.changeLike(this.topItem)
  }
})
```

## 7.6.  å›å¤è¯„è®º

- åº•éƒ¨è¾“å…¥ç»„ä»¶åŒå‘ç»‘å®š

```typescript
@ComponentV2
struct HmReplyInput {
  @Local content: string = ""
  @Event publishComment: (content: string) => void = () => {}
  build() {
    Row({ space: 10 }) {
      TextInput({ text: $$this.content, placeholder: 'ï½è¯·ç•™ä¸‹æ‚¨çš„ç¥è¯„è®º' })
        .layoutWeight(1)
        .height(40)
        .onSubmit(() => {
          // é”®ç›˜çš„ç¡®å®šäº‹ä»¶
          if(this.content) {
            this.publishComment(this.content)
            this.content = ""
          }
        })
      Button("å‘å¸ƒ")
        .onClick(() => {
          if(this.content) {
            this.publishComment(this.content)
            this.content = ""
          }
        })
    }
    .padding({ left: 10, right: 10 })
    .width('100%')
    .height(60)
  }
}
export { HmReplyInput }
```

- è°ƒç”¨çˆ¶ç»„ä»¶ä¼ å…¥çš„publishCommentçš„æ–¹æ³•

- çˆ¶ç»„ä»¶å®ç°çš„æ–¹æ³•

  

```typescript
addComment(content: string) {
  this.commentList.unshift(new ReplyItemModel({
    id: Math.random() ,
    avatar: 'https://foruda.gitee.com/avatar/1705232317138324256/1759638_itcast_panpu_1705232317.png',
    author: 'å¸…é¹',
    content,
    time: `${(new Date().getMonth() + 1).toString().padStart(2, "0")}-${new Date().getDate().toString().padStart(2,  "0")}`,
    area: 'ä¸Šæµ·',
    likeNum: 0,
    likeFlag: false
  }))
}
```

- å®ç°ä¼ å…¥æ–¹æ³•

```typescript
HmReplyInput({
 publishComment: (content: string) => {
    this.addComment(content)
 }
})
```

- å®ç°æ»šåŠ¨é¡¶éƒ¨

```ts
//åˆ›å»ºscroller
scroller:Scroller = new Scroller()

//ä¼ å…¥scroller
List({ scroller: this.scroller })


addComment(content: string) {
  this.commentList.unshift(new ReplyItemModel({
    id: Math.random() ,
    avatar: 'https://foruda.gitee.com/avatar/1705232317138324256/1759638_itcast_panpu_1705232317.png',
    author: 'å¸…é¹',
    content,
    time: `${(new Date().getMonth() + 1).toString().padStart(2, "0")}-${new Date().getDate().toString().padStart(2,  "0")}`,
    area: 'ä¸Šæµ·',
    likeNum: 0,
    likeFlag: false
  }))
  this.scroller.scrollEdge(Edge.Start)
}
```

