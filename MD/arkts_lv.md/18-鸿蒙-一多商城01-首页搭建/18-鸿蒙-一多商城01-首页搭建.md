# 5. å·¥ç¨‹çº§ä¸€å¤šï¼ˆæŒæ¡ï¼‰

[å·¥ç¨‹ç®¡ç†](https://developer.huawei.com/consumer/cn/doc/best-practices-V5/bpta-layered-architecture-design-V5)

## 5.1. æ¦‚å¿µ

ä¸€å¤šæ¨¡å¼ä¸‹ï¼Œå®˜æ–¹æ¨èåœ¨å¼€å‘è¿‡ç¨‹ä¸­é‡‡ç”¨"ä¸‰å±‚å·¥ç¨‹æ¶æ„"ï¼Œå…¶å®å°±æ˜¯**æŠŠé¡¹ç›®æ‹†åˆ†æˆä¸åŒç±»å‹çš„æ¨¡å—ï¼Œå†é€šè¿‡æ¨¡å—ä¹‹é—´çš„å¼•ç”¨ç»„åˆï¼Œæœ€ç»ˆå®ç°åº”ç”¨åŠŸèƒ½**ï¼Œæ‹†åˆ†è§„èŒƒå¦‚ä¸‹ï¼š

- commons(å…¬å…±èƒ½åŠ›å±‚)ï¼šç”¨äºå­˜æ”¾å…¬å…±åŸºç¡€èƒ½åŠ›åˆé›†ï¼Œæ¯”å¦‚å·¥å…·åº“ï¼Œå…¬å…±é…ç½®ç­‰
- features(åŸºç¡€ç‰¹æ€§å±‚)ï¼šç”¨äºå­˜æ”¾åº”ç”¨ä¸­ç›¸å¯¹ç‹¬ç«‹çš„å„ä¸ªåŠŸèƒ½çš„UIä»¥åŠä¸šåŠ¡é€»è¾‘å®ç°
- products(äº§å“å®šåˆ¶å±‚)ï¼šç”¨äºé’ˆå¯¹ä¸åŒè®¾å¤‡å½¢æ€è¿›è¡ŒåŠŸèƒ½å’Œç‰¹æ€§é›†æˆï¼Œä½œä¸ºåº”ç”¨å…¥å£

æ‰‹æœº-æŠ˜å å±-å¹³æ¿

productsï¼šåªæ˜¯ä¸€ä¸ªå…¥å£ï¼Œåº”è¯¥ä¸è´Ÿè´£å…·ä½“çš„ä¸šåŠ¡ï¼Œå¯ä»¥å†™ä¸šåŠ¡

featuresï¼šå†™å…·ä½“ä¸šåŠ¡ï¼ŒæŠŠæ¯ä¸ªä¸šåŠ¡æ‹†åˆ†æˆå…·ä½“çš„æ¨¡å— Nä¸ªï¼Œæ–¹ä¾¿ç»´æŠ¤

commonsï¼š æä¾›åŸºç¡€ç»„ä»¶-åŸºç¡€å·¥å…·-åŸºç¡€ç±»å‹- æ¶æ„ç»„-æŠ€æœ¯å¹³å°ç»„



hap-å¯ä»¥ç”¨Ability

har-æ²¡æœ‰Ability-é‡å¤æ‹·è´

hsp-æ²¡æœ‰Ability-ç›´æ¥å¼•ç”¨æ²¡æœ‰æ‹·è´



**æ³¨æ„ï¼šé¢è¯•è¦é—®ï¼ï¼ï¼**

[åŒ…çš„åŒºåˆ«](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/application-package-structure-stage-V5#é€‰æ‹©åˆé€‚çš„åŒ…ç±»å‹)

å‚è€ƒå®˜æ–¹ç¤ºä¾‹ï¼šç¾è”»å•†åŸå°†è¿›è¡Œå¦‚ä¸‹æ‹†åˆ†

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717149698534-40fc215e-39a8-4831-8055-5ef57e0d5a26.png)

1. commonè®¾è®¡ä¸ºhspåŒ…ï¼Œæ–°å»ºmoduleæ—¶é€‰æ‹©`Shared Library`, å†…éƒ¨å­˜æ”¾å…¨å±€é€šç”¨çš„å·¥å…·å‡½æ•°ï¼Œå…¬å…±é…ç½®ç­‰
2. featureè®¾è®¡ä¸ºhspåŒ…ï¼Œæ–°å»ºmoduleæ—¶é€‰æ‹© `Shared Library`, å†…éƒ¨å­˜æ”¾ç›¸å¯¹ç‹¬ç«‹çš„ä¸šåŠ¡å•å…ƒï¼Œæ¯”å¦‚`è´­ç‰©è½¦` ã€`æˆ‘çš„` ã€`åˆ†ç±»`ã€`Home` ï¼Œä¹Ÿå°±æ˜¯é¦–é¡µåº•éƒ¨Tabåˆ‡æ¢æ—¶çš„å››ä¸ªæ ¸å¿ƒä¸šåŠ¡æ¨¡å—
3. productä¸ºäº§å“å±‚ï¼Œé‡Œé¢æ”¾ç½®phoneæ¨¡å—ï¼Œä¹Ÿå°±æ˜¯å…¥å£æ¨¡å—ï¼Œåœ¨phoneä¸­æˆ‘ä»¬æ”¾ç½®å…¥å£abilityå’Œæ‰€æœ‰é¡µé¢çº§åˆ«çš„ç»„ä»¶ï¼ˆhapï¼‰

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717149305821-e77973cd-8d42-416f-82c6-924946c15dc2.png)

é€‰ç”¨ **Shared Library**çš„åŸå› ï¼š

![img](https://cdn.nlark.com/yuque/0/2024/png/8435673/1712916416182-07dc1510-8dc3-4407-a57c-4678af9b21ff.png?x-oss-process=image%2Fformat%2Cwebp)



## 5.2. é¡¹ç›®æ­å»º

æ¥ä¸‹æ¥å’±ä»¬å®Œæˆé¡¹ç›®æ­å»ºï¼Œå‚è€ƒä¸‹å›¾

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717343762739-b361189f-896e-4394-abba-67cf4853d44a.png)

**æ ¸å¿ƒæ­¥éª¤ï¼š**

1. åˆ›å»ºé¡¹ç›®: é¡¹ç›®åç”¨ AGC å¹³å°åˆ›å»ºçš„é¡¹ç›®å
2. åˆ›å»ºç›®å½• commonsã€featuresã€products
3. commonsç›®å½•ä¸‹

- - åˆ›å»º **Shared Libraryï¼Œ**èµ·å basicï¼Œå­˜æ”¾å…¨å±€é€šç”¨çš„å·¥å…·å‡½æ•°ï¼Œå…¬å…±é…ç½®ç­‰

1. features ç›®å½•ä¸‹ï¼š

- - åˆ›å»º **Shared Libraryï¼š**å†…éƒ¨å­˜æ”¾ç›¸å¯¹ç‹¬ç«‹çš„ä¸šåŠ¡å•å…ƒï¼Œæ¯”å¦‚`è´­ç‰©è½¦ï¼ˆcartï¼‰` ã€`æˆ‘çš„(my)` ã€`åˆ†ç±»(category)`ã€`é¦–é¡µï¼ˆhome)` ï¼Œä¹Ÿå°±æ˜¯é¦–é¡µåº•éƒ¨Tabåˆ‡æ¢æ—¶çš„å››ä¸ªæ ¸å¿ƒä¸šåŠ¡æ¨¡å—

1. products ç›®å½•ä¸‹ï¼š

- - å°†åŸæœ¬çš„ **entry**ï¼Œç§»å…¥è¯¥ç›®å½•å¹¶æ”¹åä¸º **phone**

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717381715200-4aaad0ed-c18e-413d-b823-82ffe9adbeeb.png)



![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717343980456-17ea7df0-fc18-4c82-b8ab-ccbc4327e323.png)

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717343999452-d3a564e7-30e9-485a-aacc-67fea4d0bd90.png)

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1724049366986-2c5b6f81-1fe1-4a56-bbd4-3816c7bd25be.png?x-oss-process=image%2Fformat%2Cwebp)

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717344045130-7fb1a99c-f166-4fe4-9ad3-ccb327f66997.png)

**æ³¨æ„ï¼š è¿è¡Œæ—¶ï¼Œ å…¥å£é€‰æ‹©phone**

![img](https://cdn.nlark.com/yuque/0/2025/png/38706227/1742740903025-b16f9d3c-c900-42de-b022-467700854b70.png)



# 6. å‡†å¤‡å·¥ä½œï¼š

æ¥ä¸‹æ¥å®Œæˆæ¨¡å—ç¼–ç å‰æœŸçš„å‡†å¤‡å·¥ä½œ

1. å›¾æ ‡+åå­—
2. åº•éƒ¨ tabs
3. æ—¥å¿—å·¥å…·



## 6.1. å›¾æ ‡+åå­—

è¦è°ƒæ•´çš„åœ°æ–¹æœ‰ 2 ä¸ª

1. ç®¡ç†ç•Œé¢çš„åå­—+å›¾æ ‡
2. æ¡Œé¢çš„åå­—+å›¾æ ‡

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717380677628-757ff7b4-f6f6-4d19-84c5-1085cfa71f36.png)![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717380707086-32a53ec6-a033-4f95-ae48-5f96506ddede.png)



1. ç®¡ç†ç•Œé¢å›¾æ ‡+åå­—ï¼š[ğŸ“åº”ç”¨ç®¡ç†ç•Œé¢å›¾æ ‡.zip](https://www.yuque.com/attachments/yuque/0/2025/zip/38706227/1747031189167-78f19d2d-f33d-4f5a-90f6-2645e6655ea6.zip)

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717380803871-40e7ca5f-fb0b-424b-88cd-6f1fba16ddfe.png)

1. æ¡Œé¢çš„åå­—+å›¾æ ‡

```ts
{
  "module": {
    "name": "phone",
    "type": "entry",
    "description": "$string:module_desc",
    "mainElement": "EntryAbility",
    "deviceTypes": [
      "phone",
      "tablet",
      "2in1"
    ],
    "deliveryWithInstall": true,
    "installationFree": false,
    "pages": "$profile:main_pages",
    "abilities": [
      {
        "name": "EntryAbility",
        "srcEntry": "./ets/entryability/EntryAbility.ets",
        "description": "$string:EntryAbility_desc",
        "icon": "$media:foreground",
        "label": "$string:EntryAbility_label",
        "startWindowIcon": "$media:startIcon",
        "startWindowBackground": "$color:start_window_background",
        "exported": true,
        "skills": [
          {
            "entities": [
              "entity.system.home"
            ],
            "actions": [
              "action.system.home"
            ]
          }
        ]
      }
    ]
  }
}
```



## 6.2. åº•éƒ¨ tabs æ­å»ºï¼š

[è·¨ HAP/HSPåº”ç”¨èµ„æº](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/resource-categories-and-access-V5#è·¨haphspåŒ…åº”ç”¨èµ„æº)

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717345327177-b502374d-1bf7-4abb-93c8-8e88e7aca6ba.png)

**åŸºç¡€æ¨¡ç‰ˆï¼š**

```ts
products/phone/src/main/ets/pages/Index.ets


interface TabItem {
  text: string
  normal: ResourceStr
  active: ResourceStr
}

@Entry
@ComponentV2
struct Index {
  @Local
  activeIndex: number = 0
  list: TabItem[] = [
    { text: 'é¦–é¡µ', normal: $r('app.media.ic_public_home_normal'), active: $r('app.media.ic_public_home_active') },
    { text: 'åˆ†ç±»', normal: $r('app.media.ic_public_pro_normal'), active: $r('app.media.ic_public_pro_active') },
    { text: 'è´­ç‰©è¢‹', normal: $r('app.media.ic_public_cart_normal'), active: $r('app.media.ic_public_cart_active') },
    { text: 'æˆ‘çš„', normal: $r('app.media.ic_public_my_normal'), active: $r('app.media.ic_public_my_active') },
  ]

  @Builder
  getTabItemBuilder(item: TabItem, index: number) {
    Column() {
      Image(this.activeIndex === index ? item.active : item.normal)
        .width(24)
        .aspectRatio(1)
      Text(item.text)// è·¨ HSP è®¿é—®èµ„æºï¼Œéœ€è¦åœ¨ oh-package.json5ä¸­å¯¼å…¥
        .fontColor($r('[basic].color.black'))
        .fontSize(12)
    }
    .justifyContent(FlexAlign.SpaceEvenly)
    .height(50)
  }

  build() {
    Tabs({ barPosition: BarPosition.End, index: $$this.activeIndex }) {
      ForEach(this.list, (item: TabItem, index: number) => {
        TabContent() {

        }
        .tabBar(this.getTabItemBuilder(item, index))
      })
    }
    .scrollable(false)
  }
}
```

1. 

2. ```
   {
     "name": "phone",
     "version": "1.0.0",
     "description": "Please describe the basic information.",
     "main": "",
     "author": "",
     "license": "",
     "dependencies": {
       "basic": "file:../../commons/basic",
     }
   }
   ```

3. 



**é¢œè‰²:**

```ts
{
  "color": [
    {
      "name": "black",
      "value": "#191919"
    },
    {
      "name": "white",
      "value": "#FFFFFF"
    },
    {
      "name": "text",
      "value": "#434343"
    },
    {
      "name": "gray",
      "value": "#A6A3AD"
    },
    {
      "name": "red",
      "value": "#FF2737"
    },
    {
      "name": "linear_begin",
      "value": "#FD3F8F"
    },
    {
      "name": "linear_end",
      "value": "#FF773C"
    },
    {
      "name": "yellow",
      "value": "#F2E7DC"
    },
    {
      "name": "under",
      "value": "#F5F4F9"
    },
    {
      "name": "border",
      "value": "#e4e4e4"
    }
  ]
}

```

æ³¨æ„ï¼š

1. keyä¸ºä½¿ç”¨æ¨¡å—æ—¶çš„åå­—ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæ ‡è¯†ï¼Œä¿æŒè§„èŒƒå³å¯ï¼Œvalueä¸ºæ¨¡å—çš„å®é™…åœ°å€ï¼Œä¸èƒ½å†™é”™
2. è·¨æ¨¡å—è®¿é—®èµ„æºï¼Œéœ€è¦ã€å…ˆå¯¼å…¥æ¨¡å—ã€‘æ‰å¯ä»¥è®¿é—®





## 6.3. å¼•å…¥ features æ¨¡å—

æ¥ä¸‹æ¥å°† 4 ä¸ª tabs å¯¹åº”çš„ç»„ä»¶åˆ›å»ºå¥½å¹¶æ•´åˆåˆ° index é¡µé¢ï¼Œè¿™å‡ ä¸ªéƒ½æ˜¯ tabs ç®¡ç†çš„ç»„ä»¶

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1724057801414-00a98fce-1786-4124-9ab1-1fc5e9a46123.png?x-oss-process=image%2Fformat%2Cwebp)

**æ ¸å¿ƒæ­¥éª¤ï¼š**

1. åˆ›å»ºåŸºæœ¬é¡µé¢:
2. å¯¼å‡º:
3. å¯¼å…¥å¹¶ä½¿ç”¨

1. åˆ›å»ºåŸºæœ¬é¡µé¢ï¼š

1. 1. ets ä¸‹åˆ›å»º views ç›®å½•ï¼Œé¡µé¢å‘½åå‚è€ƒï¼š

1. 1. 1. CartViewï¼šè´­ç‰©è½¦
      2. CategoryViewï¼šåˆ†ç±»
      3. HomeViewï¼šä¸»é¡µ
      4. MyViewï¼šæˆ‘çš„

1. 1. é¡µé¢å†…å®¹å‚è€ƒæˆªå›¾ï¼Œè®¾ç½®åŸºç¡€ç»“æ„å³å¯

![img](https://cdn.nlark.com/yuque/0/2025/png/38706227/1747031876997-f49ddeb4-9999-4d31-9b85-29a14028f85a.png)

1. å¯¼å‡º:

1. 1. 4ä¸ª tabs å¯¹åº”çš„æ¨¡å—éƒ½éœ€è¦å¯¼å‡º
   2. å‚è€ƒä»£ç å¦‚ä¸‹

```ts
cart/index.ets
export { CartView } from './src/main/ets/views/CartView'
```

1. å¯¼å…¥å¹¶ä½¿ç”¨:

```ts
{
  "name": "phone",
  "version": "1.0.0",
  "description": "Please describe the basic information.",
  "main": "",
  "author": "",
  "license": "",
  "dependencies": {
    "basic": "file:../../commons/basic"
    "home": "file:../../features/home",
    "cart": "file:../../features/cart",
    "category": "file:../../features/category",
    "my": "file:../../features/my",
  }
}
import { TabItem } from 'basic'
import { HomeView } from 'home/Index';
import { CategoryView } from 'category/Index';
import { CartView } from 'cart/Index';
import { MyView } from 'my/Index';

@Entry
@ComponentV2
struct Index {
  @Local
  activeIndex: number = 0
  list: TabItem[] = [
    { text: 'é¦–é¡µ', normal: $r('app.media.ic_public_home_normal'), active: $r('app.media.ic_public_home_active') },
    { text: 'åˆ†ç±»', normal: $r('app.media.ic_public_pro_normal'), active: $r('app.media.ic_public_pro_active') },
    { text: 'è´­ç‰©è¢‹', normal: $r('app.media.ic_public_cart_normal'), active: $r('app.media.ic_public_cart_active') },
    { text: 'æˆ‘çš„', normal: $r('app.media.ic_public_my_normal'), active: $r('app.media.ic_public_my_active') },
  ]

  build() {
    Tabs({ barPosition: BarPosition.End }) {
      ForEach(this.list, (item: TabItem, index: number) => {
        TabContent() {
          if (index == 0) {
            HomeView()
          } else if (index == 1) {
            CategoryView()
          } else if (index == 2) {
            CartView()
          } else {
            MyView()
          }
        }
        .tabBar(this.TabItemBuilder(item, index))
      })
    }
    .scrollable(false)
    .onTabBarClick(index => {
      this.activeIndex = index
    })
  }

  @Builder
  TabItemBuilder(item: TabItem, index: number) {
    Column() {
      Image(this.activeIndex === index ? item.active : item.normal)
        .width(24)
        .aspectRatio(1)
      Text(item.text)
        .fontColor($r('app.color.black'))
        .fontSize(12)
    }
    .justifyContent(FlexAlign.SpaceEvenly)
    .height(50)
  }


}
```

gitè®°å½•ï¼š

**å¼•å…¥ features æ¨¡å—**

## 6.4. æ—¥å¿—å·¥å…·ï¼š

[Logger å·¥å…·](https://ohpm.openharmony.cn/#/cn/detail/@abner%2Flog)

HarmonyOsLogæ˜¯ä¸€ä¸ªæ—¥å¿—æ‰“å°å·¥å…·ï¼Œæ”¯æŒhilogå’Œconsoleä¸¤ç§å·¥å…·æ‰“å°ï¼Œæ”¯æŒå„ç§ç±»å‹åŒ…å«JSONæ ¼å¼åŒ–æ‰“å°ï¼Œéå¸¸çš„æ–¹ä¾¿ï¼



![img](https://cdn.nlark.com/yuque/0/2024/jpeg/639379/1717378998616-7a2b3929-75ff-47c8-9f25-94da5ffbc784.jpeg)

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717378998715-cfa04c40-e6f4-464a-90be-417e4b65bd11.png)

éœ€æ±‚ï¼š

1. åœ¨commons/basic

1. 1. ä¸‹è½½ logger æ—¥å¿—å·¥å…·
   2. å®Œæˆåˆå§‹åŒ–å¹¶å¯¼å‡ºï¼Œèµ·åˆ«åLogger

1.  products/phoneä¸­æµ‹è¯•ä½¿ç”¨



1. å®‰è£…

  a. åœ¨ commons/basicä¸‹æ‰“å¼€ç»ˆç«¯è¿›è¡Œå®‰è£…
  b. mac å’Œ window ç•Œé¢å¯èƒ½ç•¥æœ‰å·®å¼‚

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1724058661745-a164c9ad-2832-40a6-b023-ceba455e5e51.png?x-oss-process=image%2Fformat%2Cwebp%2Fresize%2Cw_518%2Climit_0)

```arkts
ohpm install @abner/log
```

1. åˆå§‹åŒ–ï¼Œèµ·åˆ«åï¼Œå¯¼å‡º

```typescript
import { Log } from '@abner/log'

// åˆå§‹åŒ–
Log.init({
  tag: "MkLog",
  domain: 0x0101,
  close: false,
  isHilog: true,
  showLogLocation: true,
  logSize: 1024
})


export {
  Log as Logger
}

```

```

export { Logger } from './src/main/ets/utils/Logger'
```



1. æµ‹è¯•ä½¿ç”¨:

```ts
// å¯¼å…¥
import { Logger } from '@mk/basic'


// æµ‹è¯•ä½¿ç”¨
aboutToAppear(): void {
    Logger.info({
      name: 'é¸¿è’™ç‰›é€¼',
      age: 18
    })
}
```

![img](https://cdn.nlark.com/yuque/0/2024/png/38706227/1724050104866-e4a50fbc-daec-460d-8a88-fda82079d9f8.png)



# äºŒã€é¦–é¡µæ¨¡å—

æ ¸å¿ƒï¼š

Home æ¨¡å—ï¼š

1. é¡µé¢é€‚é…
2. ç½‘ç»œæ•°æ®æ•´åˆ



# 1. é¡µé¢çº§ä¸€å¤šå¼€å‘ï¼š

## 1.1. phone-tabs é€‚é…

å®Œæˆ tabs éƒ¨åˆ†çš„ ui é€‚é…

[tabsæ–‡æ¡£](https://docs.openharmony.cn/pages/v4.1/zh-cn/application-dev/ui/arkts-navigation-tabs.md)

**éœ€æ±‚ï¼š**

1. smã€mdï¼šåº•éƒ¨
2. lg:å·¦ä¾§

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717405458911-f01365a1-b1b0-4b4d-b10f-6448fea8b6bd.png)![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717405435344-c1ea750e-9614-4a4a-93c7-242b08813e75.png)

æ ¸å¿ƒæ­¥éª¤

- åœ¨common/basicæ¨¡å—ä¸­å»ºç«‹ä¸€ä¸ªåª’ä½“æŸ¥è¯¢çš„å·¥å…·
- å»ºç«‹å¯¹åº”çš„æ–­ç‚¹æšä¸¾
- å»ºç«‹å¯¹åº”çš„AppStorageV2çš„å­˜å‚¨æ–­ç‚¹å¯¹è±¡
- åœ¨products/phone çš„abilityä¸­è¿›è¡Œç›‘å¬å’Œå¸è½½ç›‘å¬- åªèƒ½åœ¨åŠ è½½é¡µé¢ä¹‹åæ‰§è¡Œï¼ˆéœ€è¦æ³¨æ„ï¼‰
- æ ¹æ®æ–­ç‚¹å€¼ => tabsçš„tabBaråœ¨lgæ¨¡å¼ä¸‹æ”¾åˆ°å·¦ä¾§
- å°†å®˜æ–¹çš„æ¨èçš„æ–­ç‚¹æè¿°å·¥å…·æ”¾ç½®åœ¨basicæ¨¡å—ä¸‹
- ä½¿ç”¨æè¿°å·¥å…·å°†lgæ¨¡å¼ä¸‹çš„tabbaræ”¾åˆ°å·¦ä¾§



- å®šä¹‰ç›¸åº”çš„æšä¸¾

```ts
commons/basic/src/main/ets/viewmodels/break_point.ets

export enum BreakPointEnum {
  XS = "xs",
  SM = "sm",
  MD = "md",
  LG = "lg"
}
```

- å®šä¹‰å…¨å±€çŠ¶æ€å…±äº«çŠ¶æ€

```typescript
commons/basic/src/main/ets/viewmodels/common.ets

import { BreakPointEnum } from "./break_point";

// V2çš„å…±äº«ç±»çš„çŠ¶æ€
@ObservedV2
export class AppBreakPoint {
  @Trace
  breakPoint: BreakPointEnum = BreakPointEnum.XS
}

```

```ts
commons/basic/src/main/ets/viewmodels/index.ets

export * from './break_point' // å¯¼å‡ºæ–­ç‚¹
export * from './common' // å¯¼å‡ºå…¬å…±çš„å±æ€§
```



---------------

```ts
commons/basic/src/main/ets/utils/BreakPointUtil.ets

import { Context } from "@kit.AbilityKit"
import { AppStorageV2, display, window } from "@kit.ArkUI"
import { AppBreakPoint, BreakPointEnum } from "../viewmodels"

export class ScreenManager {
  ctx?: Context

  // æ³¨å†Œå±å¹•å®½åº¦å˜åŒ–
  async registerWindowSizeChange() {
    const win = await this.getWin() // è·å–windowå¯¹è±¡
    this.judgeScreen(px2vp(display.getDefaultDisplaySync().width)) // ç¬¬ä¸€æ¬¡æ‰‹åŠ¨åˆ¤æ–­ä¸€æ¬¡
    win.on("windowSizeChange", (size) => {
      this.judgeScreen(px2vp(size.width)) // vpåŒºé—´
    })
  }

  // åˆ¤æ–­å±å¹•
  judgeScreen(width: number) {
    let breakPoint: BreakPointEnum = BreakPointEnum.XS
    if (width > 0 && width < 320) {
      breakPoint = BreakPointEnum.XS
    } else if (width >= 320 && width < 520) {
      breakPoint = BreakPointEnum.SM
    } else if (width >= 520 && width < 840) {
      breakPoint = BreakPointEnum.MD
    } else {
      breakPoint = BreakPointEnum.LG
    }
    //   V1 AppStorage.setOrCreate("key", "value")
    const app = AppStorageV2.connect(AppBreakPoint, () => new AppBreakPoint())!
    app.breakPoint = breakPoint // å°†æ–­ç‚¹å€¼å­˜å…¥åˆ°å…¨å±€çŠ¶æ€
  }

  // å–æ¶ˆæ³¨å†Œ
  async unRegisterWindowSizeChange() {
    const win = await this.getWin() // è·å–windowå¯¹è±¡
    win.off("windowSizeChange") // å¸è½½ç›‘å¬
  }

  getWin() {
    return window.getLastWindow(this.ctx || getContext())
  }
}

export const screenManager = new ScreenManager()
```

```ts
src/main/ets/utils/Logger.ets

export * from './BreakPointUtil' // å±å¹•ç®¡ç†å·¥å…·
export * from './Logger' // è¯·æ±‚å·¥å…·
```

```ts
commons\basic\Index.ets

export * from './src/main/ets/viewmodels' // å‘å¤–æš´éœ²ç±»å‹
export * from './src/main/ets/utils' // å·¥å…·ä½¿ç”¨
```



- åœ¨abilityä¸­ç›‘å¬åª’ä½“æŸ¥è¯¢å’Œå¸è½½åª’ä½“

```ts
products/phone/src/main/ets/entryability/EntryAbility.ets


onWindowStageCreate(windowStage: window.WindowStage): void {
    // Main window is created, set main page for this ability
    hilog.info(DOMAIN, 'testTag', '%{public}s', 'Ability onWindowStageCreate');
    screenManager.ctx = this.context
    screenManager.registerWindowSizeChange() // æ³¨å†Œå±å¹•å˜åŒ–
    windowStage.loadContent('pages/Index', (err) => {
      if (err.code) {
        hilog.error(DOMAIN, 'testTag', 'Failed to load the content. Cause: %{public}s', JSON.stringify(err));
        return;
      }
      hilog.info(DOMAIN, 'testTag', 'Succeeded in loading the content.');
    });
  }

  onWindowStageDestroy(): void {
    // Main window is destroyed, release UI related resources
    hilog.info(DOMAIN, 'testTag', '%{public}s', 'Ability onWindowStageDestroy');
    screenManager.unRegisterWindowSizeChange() // å–æ¶ˆæ³¨å†Œ
  }
```

- æ”¾ç½®ä¸€ä¸ªæ–­ç‚¹æè¿°å·¥å…·åˆ°basic

```ts
commons/basic/src/main/ets/viewmodels/break_point.ets

export enum BreakPointEnum {
  XS = "xs",
  SM = "sm",
  MD = "md",
  LG = "lg"
}

// å°è£…ä¸€ä¸ªå·¥å…· å¯ä»¥å¸®æˆ‘ä»¬å®ç°é€‚é…çš„æ›´ç®€å•ä¸€ç‚¹

interface BreakPointOption<T> {
  xs?: T
  sm?: T
  md?: T
  lg?: T
}

export class BreakPointType<T> {
  options: BreakPointOption<T> = {}

  constructor(opt: BreakPointOption<T>) {
    this.options = opt // å°†ä¼ å…¥çš„æ–­ç‚¹çš„å€¼èµ‹å€¼ç»™å¯¹è±¡
  }

  getValue(breakPoint: BreakPointEnum): T {
    return (this.options as object)[breakPoint]
    // if (breakPoint === BreakPointEnum.XS) {
    //   return this.options.xs!
    // } else if (breakPoint === BreakPointEnum.SM) {
    //   return this.options.sm!
    // } else if (breakPoint === BreakPointEnum.MD) {
    //   return this.options.md!
    // } else {
    //   return this.options.lg!
    // }
  }
}
```

- åœ¨phoneçš„å…¥å£é¦–é¡µå®ç°lgæ¨¡å¼ä¸‹çš„é€‚é…

```ts
products/phone/src/main/ets/pages/Index.ets

import { AppBreakPoint, BreakPointType, TabItem } from 'basic'
import { CartView } from 'cart'
import { CategoryView } from 'category'
import { HomeView } from 'home'
import { MineView } from 'mine'
import { AppStorageV2 } from '@kit.ArkUI'

@Entry
@ComponentV2
struct Index {
  breakObj: AppBreakPoint = AppStorageV2.connect(AppBreakPoint, () => new AppBreakPoint())!
  @Local
  activeIndex: number = 0
  list: TabItem[] = [
    { text: 'é¦–é¡µ', normal: $r('app.media.ic_public_home_normal'), active: $r('app.media.ic_public_home_active') },
    { text: 'åˆ†ç±»', normal: $r('app.media.ic_public_pro_normal'), active: $r('app.media.ic_public_pro_active') },
    { text: 'è´­ç‰©è¢‹', normal: $r('app.media.ic_public_cart_normal'), active: $r('app.media.ic_public_cart_active') },
    { text: 'æˆ‘çš„', normal: $r('app.media.ic_public_my_normal'), active: $r('app.media.ic_public_my_active') },
  ]

  @Builder
  getTabItemBuilder(item: TabItem, index: number) {
    Column() {
      Image(this.activeIndex === index ? item.active : item.normal)
        .width(24)
        .aspectRatio(1)
      Text(item.text)// è·¨ HSP è®¿é—®èµ„æºï¼Œéœ€è¦åœ¨ oh-package.json5ä¸­å¯¼å…¥
        .fontColor($r("[basic].color.black"))
        .fontSize(12)
    }
    .justifyContent(FlexAlign.SpaceEvenly)
    .height(50)
  }

  build() {
    Tabs({
      barPosition: new BreakPointType({
        sm: BarPosition.End,
        md: BarPosition.End,
        lg: BarPosition.Start
      }).getValue(this.breakObj.breakPoint), index: $$this.activeIndex
    }) {
      ForEach(this.list, (item: TabItem, index: number) => {
        TabContent() {
          if (index === 0) {
            HomeView()
          } else if (index === 1) {
            CategoryView()
          } else if (index === 2) {
            CartView()
          } else {
            MineView()
          }
        }
        .tabBar(this.getTabItemBuilder(item, index))
      })
    }
    .barHeight(new BreakPointType({
      sm: 60,
      md: 60,
      lg: 220
    }).getValue(this.breakObj.breakPoint))
    .vertical(new BreakPointType({
      sm: false,
      md: false,
      lg: true
    }).getValue(this.breakObj.breakPoint))
    .scrollable(false)
  }
}
```

![img](https://cdn.nlark.com/yuque/0/2025/png/8435673/1743040975825-d3ee5715-26e1-4b3e-ba84-54188a90ebf4.png)



## 1.2. Home æ¨¡å—

Home æ¨¡å—çš„ä¸€å¤šå¼€å‘

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717425374860-3b347ad9-f87f-4ecf-a2a5-e7abaa75f020.png)

### 1.2.1. ç´ ææ•´åˆ

å°†å›¾ç‰‡èµ„æºï¼Œé¡µé¢ï¼Œç»„ä»¶ï¼Œæ¨¡å—è¿™äº›æ•´åˆè¿›æ¥

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1724120393846-81402b54-4640-476a-8f17-165d0dba0a34.png)

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1724406716402-0d51e880-e2df-482b-aeca-c2336ee0e027.png)

**æ ¸å¿ƒæ­¥éª¤ï¼š**

1. commonï¼š

1. 1. é€šç”¨å›¾ç‰‡ï¼šcommons/basic/src/main/resources/base/media

1. 1. 

1. home:

1. 1. å›¾ç‰‡èµ„æº

1. phone:(ä¿è¯ç½‘ç»œå›¾ç‰‡å¯ä»¥æ˜¾ç¤º)

1. 1. å¼€å¯ç½‘ç»œæƒé™ï¼šproducts/phone/src/main/module.json5

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717495593129-08107f47-4ddd-439e-9929-888bb6e85530.png)

- è°ƒæ•´èŒƒå›´
- homeæ¨¡å—çš„viewmodels/index.ets  ç»Ÿä¸€ç®¡ç†æ¨¡å¼
- homeæ¨¡å—ä¸‹components/index.ets ç»Ÿä¸€ç®¡ç†æ¨¡å¼



- basicæ¨¡å—ä¸‹ç»Ÿä¸€ç®¡ç†çš„å…¬å…±ç±»å‹

```ts
commons/basic/src/main/ets/viewmodels/business.ets

export interface HDMGoodsItem {
  id: string
  name: string
  desc: string
  price: string
  picture: ResourceStr
  orderNum: number
}

export interface CategoryItem {
  children?: CategoryItemChild[]
  goods?: HDMGoodsItem[]
  id: string
  name: string
  picture: ResourceStr
}

export interface CategoryItemChild {
  id: string
  name: string
  picture: ResourceStr
}
```

- åœ¨homeæ¨¡å—æ·»åŠ å¯¹äºbasicä¾èµ–

```bash
{
  "name": "home",
  "version": "1.0.0",
  "description": "Please describe the basic information.",
  "main": "Index.ets",
  "author": "",
  "license": "Apache-2.0",
  "packageType": "InterfaceHar",
  "dependencies": {
    "basic": "file:../../commons/basic"
  }
}
```

- åœ¨basic/viewmodes/index.etsç»Ÿä¸€æ³¨å†Œ

```ts
commons/basic/src/main/ets/viewmodels/index.ets

export * from './business'
```

- homeæ¨¡å—ä¸‹çš„ç»„ä»¶

![img](https://cdn.nlark.com/yuque/0/2024/png/8435673/1730687936993-4897aadd-0378-49f1-b3c1-6a1b9bbb5817.png)

```ts
features/home/src/main/ets/components/HDMDiscountGoods.ets

import { HDMGoodsItem } from 'basic'
import { DiscountType } from '../viewmodels'


@ComponentV2
export struct HDMDiscountGoods {
  @Param type: DiscountType = DiscountType.COMMAND
  @Param
  goods: HDMGoodsItem = {} as HDMGoodsItem

  @Builder
  CommandBuilder() {
    Column() {
      Image(this.goods.picture)
        .width(70)
        .aspectRatio(1)
      Row() {
        Stack() {
          Polygon()
            .width(16)
            .height(20)
            .points([[0, 0], [4, 0], [7, 10], [4, 20], [0, 20]])
            .fill($r('[basic].color.white'))
          Polygon()
            .width(16)
            .height(20)
            .points([[4, 0], [12, 0], [9, 6], [16, 6], [4, 20], [7, 10], [0, 10]])
            .fill('#FFC060')
        }
        .offset({ x: -1 })

        Text('Â¥' + Number(this.goods.price))
          .fontSize(12)
          .fontWeight(500)
          .fontColor($r('[basic].color.white'))
          .textAlign(TextAlign.Center)
          .width(40)
      }
      .width(60)
      .height(20)
      .linearGradient({
        angle: 135,
        colors: [['#FD3F8F', 0], ['#FF773C', 1]]
      })
      .borderRadius({
        topRight: 10,
        bottomRight: 10
      })
    }
    .width(74)
    .height(116)
    .padding({ top: 8, bottom: 8 })
    .justifyContent(FlexAlign.SpaceBetween)
  }

  @Builder
  DiscountBuilder() {
    Column({ space: 8 }) {
      Image(this.goods.picture)
        .width(54)
        .aspectRatio(1)
      Text('Â¥' + Number(this.goods.price))
        .fontSize(12)
        .fontColor('#FF4B61')
        .fontWeight(500)
      Stack({ alignContent: Alignment.Top }) {
        Image($r('app.media.home_goods_discount'))
          .width(48)
          .height(20)
        Text('ç«‹å‡ 90')
          .fontSize(8)
          .fontColor($r('[basic].color.white'))
          .lineHeight(12)
      }
    }
    .width(70)
    .height(116)
    .justifyContent(FlexAlign.Center)
  }

  @Builder
  NewBuilder() {
    Column() {
      Image(this.goods.picture)
        .width(60)
        .aspectRatio(1)
      Text('Â¥' + Number(this.goods.price))
        .fontSize(13)
        .lineHeight(30)
        .fontColor('#FF4B61')
        .fontWeight(500)
    }
    .padding(8)
    .width(80)
    .height(106)
    .borderRadius(8)
    .backgroundColor($r('[basic].color.white'))
    .justifyContent(FlexAlign.Center)
  }

  build() {
    if (this.type === DiscountType.DISCOUNT) {
      this.DiscountBuilder()
    } else if (this.type === DiscountType.NEW) {
      this.NewBuilder()
    } else {
      this.CommandBuilder()
    }
  }
}
```

- homeçš„HDMGoods

```ts
features/home/src/main/ets/components/HDMGoods.ets

import { HDMGoodsItem } from 'basic'

@ComponentV2
export struct HDMGoods {
  @Param
  goods: HDMGoodsItem = {} as HDMGoodsItem
  @Param
  smallImage: boolean = false

  build() {
    Column({ space: 10 }) {
      if (this.smallImage) {
        Row() {
          Image(this.goods.picture)
            .width('100%')
            .aspectRatio(1)
        }
        .width('100%')
        .padding(20)
      } else {
        Image(this.goods.picture)
          .width('100%')
          .aspectRatio(1)
      }
      Text(this.goods.name)
        .fontSize(14)
        .fontColor($r('[basic].color.text'))
        .maxLines(2)
        .textOverflow({ overflow: TextOverflow.Ellipsis })
        .width('100%')
        .padding({ left: 10, right: 10 })
      Row({ space: 4 }) {
        Text('Â¥' + Number(this.goods.price))
          .fontSize(14)
          .fontWeight(FontWeight.Bold)
          .fontColor($r('[basic].color.black'))
        Text('Â¥999')
          .fontSize(8)
          .fontColor($r('[basic].color.gray'))
          .decoration({ type: TextDecorationType.LineThrough, color: $r('[basic].color.gray') })
        Blank()
        Text('2.9ä¸‡+äººä»˜æ¬¾')
          .fontSize(10)
          .fontColor($r('[basic].color.gray'))
      }
      .alignItems(VerticalAlign.Bottom)
      .width('100%')
      .margin({ bottom: 10 })
      .padding({ left: 10, right: 10 })
    }
    .width('100%')
    .backgroundColor($r('[basic].color.white'))
    .borderRadius(8)
    .clip(true)
  }
}
```

- ç»„ä»¶ç»Ÿä¸€æ³¨å†Œ

```ts
features/home/src/main/ets/components/index.ets

export * from './HDMDiscountGoods'
export * from './HDMGoods'
```

- ç±»å‹æ–‡ä»¶

```ts
features/home/src/main/ets/viewmodels/home.ets


import { HDMGoodsItem } from "basic";

export interface Banner {
  id: string;
  imgUrl: string;
  type: string;
}


export interface Params {
  title: string,
  subTitle: string,
  bg: ResourceStr,
  list: HDMGoodsItem[]
}

export enum DiscountType {
  COMMAND,
  DISCOUNT,
  NEW
}
```

- ç±»å‹æ³¨å†Œ

```ts
features/home/src/main/ets/viewmodels/index.ets

export * from './home'
```

- Homeä¸»é¡µçš„ç»„ä»¶

```ts
features/home/src/main/ets/views/HomeView/HomeView.ets


import { CategoryItem, HDMGoodsItem } from 'basic'
import { HDMDiscountGoods, HDMGoods } from '../components'
import { Banner, Params, DiscountType } from '../viewmodels'


@ComponentV2
export struct HomeView {
  // è½®æ’­å›¾
  // è½®æ’­å›¾
  @Local
  banners: Banner[] = []
  // åˆ†ç±»
  @Local
  categories: CategoryItem[] = []
  // ç‰¹æƒ æ¨è
  @Local
  saleGoods: HDMGoodsItem[] = []
  // çˆ†æ¬¾æ¨è
  @Local
  hotGoods: HDMGoodsItem[] = []
  // ä¸€ç«™ä¹°å…¨
  @Local
  oneGoods: HDMGoodsItem[] = []
  // æ–°é²œå¥½ç‰©
  @Local
  newGoods: HDMGoodsItem[] = []
  @Local
  recommendGoods: HDMGoodsItem[] = []

  // ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
  mockData() {
    this.banners = new Array(6).fill({
      id: "42",
      imgUrl: "https://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/meikou/banner/nuandong_sj.png",
      hrefUrl: "/category/1181622006",
      type: "1"
    })

    this.categories = new Array(10).fill({
      id: "1181622001",
      name: "æ°”è´¨å¥³è£…",
      picture: "https://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/meikou/c1/qznz.png"
    })

    this.saleGoods = new Array(6).fill({
      "id": "1111002",
      "name": "å‰ªå‡ºç²¾è‡´æ„Ÿï¼Œé‡‘è‡´åœ†æŸ„å¤å¤å‰ªåˆ€",
      "desc": "è½»è–„è®¾è®¡ï¼Œç®€çº¦å¤§æ–¹",
      "price": "9.90",
      "picture": "https://yanxuan-item.nosdn.127.net/4c6a9c8a579b00e5e9c7b002d15a33a2.jpg",
      "orderNum": 172
    },)

    this.hotGoods = new Array(8).fill({
      "id": "1135059",
      "name": "æ‰‹å·¥å…«å¹´è€é™ˆé†‹500æ¯«å‡",
      "desc": "åœ°é“é†‡é¦™ï¼Œé†‹é…¸æµ“éƒ",
      "price": "30.00",
      "picture": "https://yanxuan-item.nosdn.127.net/77da20e77b02830a26f931901ac1a9e0.png",
      "orderNum": 147
    },)
    this.oneGoods = new Array(8).fill({
      "id": "1135079",
      "name": "å…æµ¸æ³¡ï¼Œ12ç§è°·ç‰©ä¸€æ¬¡åŒäº«ï¼Œäº”è°·ç±³400å…‹",
      "desc": "æ— éœ€æµ¸æ³¡ï¼ŒåŒç…®åŒç†Ÿ",
      "price": "9.90",
      "picture": "https://yanxuan-item.nosdn.127.net/bfe70bd66efe94f2f18061c707d2a097.png",
      "orderNum": 144
    })
    this.newGoods = new Array(8).fill({
      "id": "4027998",
      "name": "äº®ç¢Ÿå¤šæ•ˆåˆä¸€æ´—æ¶¤å—495g",
      "desc": "æ´—ç¢—æœºä¸“ç”¨ï¼Œå¼ºåŠ›å»æ±¡",
      "price": "69.90",
      "picture": "https://yanxuan-item.nosdn.127.net/e07c2b63765cf9f4a46d489c6e09c1c1.jpg",
      "orderNum": 643
    })

    this.recommendGoods = new Array(8).fill({
      "id": "4033959",
      "name": "3ç§’å¿«é€Ÿæ‹†ç´è½»æ¾ä¿å…»odinå¥¥ä¸12åŠéŸ³é˜¶å£ç´",
      "price": 329,
      "picture": "https://yanxuan-item.nosdn.127.net/937a8e46a9284e8f7e00e13911ecfbe7.png",
      "payCount": 0
    })
  }

  aboutToAppear(): void {
    // mockæ•°æ®
    this.mockData()

  }

  @Builder
  DiscountBuilder(params: Params) {

    Column() {
      Row({ space: 10 }) {
        Text(params.title)
          .fontColor($r('[basic].color.black'))
          .fontSize(14)
        Text(params.subTitle)
          .fontColor($r('[basic].color.text'))
          .fontSize(11)
      }
      .width('100%')
      .margin({ bottom: 10 })

      List({ space: 10 }) {
        ForEach(params.list, (item: HDMGoodsItem) => {
          ListItem() {
            HDMDiscountGoods({ type: DiscountType.DISCOUNT, goods: item })
          }
        })
      }
      .width('100%')
      .height(116)
      .scrollBar(BarState.Off)
      .listDirection(Axis.Horizontal)
    }
    .height(160)
    .layoutWeight(1)
    .padding(10)
    .backgroundColor(params.bg)
    .borderRadius(8)
  }

  build() {
    Scroll() {
      Column() {
        // è½®æ’­å›¾ + æœç´¢
        Stack({ alignContent: Alignment.Top }) {
          Swiper() {
            ForEach(this.banners, (item: Banner) => {
              Image(item.imgUrl)
            })
          }
          .indicator(
            DotIndicator.dot()
              .itemWidth(8)
              .itemHeight(4)
              .color('#33191919')
              .selectedItemWidth(24)
              .selectedItemHeight(4)
              .selectedColor('#191919')
          )

          Row() {
            Row({ space: 4 }) {
              Image($r('[basic].media.ic_public_search'))
                .width(16)
                .height(16)
                .fillColor($r('[basic].color.white'))
              Text('æœç´¢...')
                .fontSize(14)
                .fontColor($r('[basic].color.white'))
            }
            .backgroundColor('#33191919')
            .width('100%')
            .height(40)
            .borderRadius(20)
            .padding({ left: 12 })
          }
          .padding({ left: 16, right: 16 })
        }
        .width('100%')


        // åˆ†ç±»
        Column({ space: 10 }) {
          // åˆ†ç±»
          List({ space: 16 }) {
            ForEach(this.categories, (item: CategoryItem) => {
              ListItem() {
                Column() {
                  Image(item.picture)
                    .width(56)
                    .aspectRatio(1)
                  Text(item.name)
                    .fontSize(10)
                    .fontColor('#CC191919')
                }
                .width(60)
                .height(80)
                .borderRadius(30)

                .clip(true)
                .backgroundImage(item.picture)
                .backgroundImageSize(ImageSize.Contain)
                .backgroundImagePosition(Alignment.Center)
                .backgroundBlurStyle(
                  BlurStyle.BACKGROUND_ULTRA_THICK,
                  { scale: 0.25 }
                )
              }
            })
          }
          .width('100%')
          .height(92)
          .scrollBar(BarState.Off)
          .listDirection(Axis.Horizontal)
          .alignListItem(ListItemAlign.Center)

          // ç‰¹æƒ æ¨è
          Column({ space: 10 }) {
            Image($r('app.media.home_cmd_title'))
              .width(150)
              .height(20)
            Row() {
              Image($r('app.media.home_cmd_inner'))
                .width(86)
                .height(116)
              List({ space: 10 }) {
                ForEach(this.saleGoods, (item: HDMGoodsItem) => {
                  ListItem() {
                    HDMDiscountGoods({ goods: item })
                  }
                })
              }
              .layoutWeight(1)
              .width('100%')
              .height(116)
              .backgroundColor($r('[basic].color.white'))
              .borderRadius({
                topRight: 8,
                bottomRight: 8
              })
              .padding({ right: 10, left: 10 })
              .scrollBar(BarState.Off)
              .listDirection(Axis.Horizontal)
            }
          }
          .width('100%')
          .height(166)
          .backgroundImage($r('app.media.home_cmd_sm'))
          .backgroundImageSize(ImageSize.Cover)
          .borderRadius(8)
          .padding(10)
          .alignItems(HorizontalAlign.Start)

          // çˆ†æ¬¾æ¨è+ä¸€ç«™ä¹°å…¨
          Row({ space: 10 }) {
            this.DiscountBuilder({
              title: 'çˆ†æ¬¾æ¨è',
              subTitle: 'æœ€å—æ¬¢è¿',
              bg: '#EDF1FB',
              list: this.hotGoods
            })
            this.DiscountBuilder({
              title: 'ä¸€ç«™ä¹°å…¨',
              subTitle: 'ç²¾å¿ƒä¼˜é€‰',
              bg: '#FCF6EA',
              list: this.oneGoods
            })
          }

          // æ–°é²œå¥½ç‰©
          Column({ space: 10 }) {
            Image($r('app.media.home_new'))
              .width(146)
              .height(19)
            List({ space: 10 }) {
              ForEach(this.newGoods, (item: HDMGoodsItem) => {
                ListItem() {
                  HDMDiscountGoods({ type: DiscountType.NEW, goods: item })
                }
              })
            }
            .width('100%')
            .height(116)
            .scrollBar(BarState.Off)
            .listDirection(Axis.Horizontal)
          }
          .width('100%')
          .height(156)
          .padding(10)
          .backgroundColor('#F7EFF5')
          .borderRadius(8)
          .alignItems(HorizontalAlign.Start)

          // æ¨èå•†å“
          WaterFlow() {
            ForEach(this.recommendGoods, (item: HDMGoodsItem) => {
              FlowItem() {
                HDMGoods({ goods: item })
              }
            })
          }
          .columnsTemplate('1fr 1fr')
          .columnsGap(8)
          .rowsGap(10)

        }
        .padding({
          left: 8,
          right: 8,
          bottom: 10,
          top: 10
        })
      }
    }
    .scrollBar(BarState.Off)
  }
}
```



### 1.2.2. ç•Œé¢é€‚é…

å®Œæˆ homeæ¨¡å—çš„ä¸‹çš„é¡µé¢é€‚é…æ•ˆæœ

[module.json5](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/module-configuration-file-V5)ã€[è½®æ’­å›¾ä¸ªæ•°](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/arkts-layout-development-create-looping-V5)ã€[è½®æ’­å›¾é—´éš™](https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/ts-container-swiper-V5)

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1724127414305-8850e4bc-c8b3-4523-b536-3d4cc2d422a2.png)

**éœ€æ±‚ï¼š**

1. æ— æ³•ç¼©å°åˆ° xs èŒƒå›´ï¼ˆ2in1 è®¾å¤‡æ‰å¯ä»¥æµ‹è¯•æ•ˆæœï¼‰
2. è½®æ’­å›¾ï¼š

1. 1. smï¼šä¸€å¼ å›¾ï¼Œå¯¼èˆªç‚¹ï¼Œæ— é—´éš™
   2. mdï¼š2 å¼ å›¾ï¼Œæ— å¯¼èˆªç‚¹ï¼Œ10 é—´éš™
   3. lgï¼š3 å¼ å›¾ï¼Œæ— å¯¼èˆªç‚¹ï¼Œ20 é—´éš™

1. åˆ†ç±»
2. ç‰¹æƒ æ¨è
3. æ–°é²œå¥½ç‰©

1. 1. ä¸Šé¢ 3 ä¸ªéƒ½æ˜¯ spaceï¼šsmï¼š14ï¼Œmdï¼š36ï¼Œlgï¼š72

1. æ¨èå•†å“

1. 1. smï¼š2 åˆ—
   2. mdï¼š3 åˆ—
   3. lgï¼š4 åˆ—

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717426969641-95239595-597e-429d-bfd8-50cb258df934.png)![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717426985963-e1f8fc28-3cee-4568-8c60-03ba4448ebd5.png)

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717427008175-6dbb2691-fd39-4ca5-b621-fa68fa208bac.png)

è½®æ’­å›¾çš„é€‚é…

æ¨èå¥½ç‰©çš„é€‚é…

æ–°é²œå¥½ç‰©çš„é€‚é…

```ts
features/home/src/main/ets/views/HomeView.ets


import { AppBreakPoint, BreakPointEnum, BreakPointType, CategoryItem, HDMGoodsItem } from 'basic'
import { HDMDiscountGoods, HDMGoods } from '../components'
import { Banner, Params, DiscountType } from '../viewmodels'
import { AppStorageV2 } from '@kit.ArkUI'


@ComponentV2
export struct HomeView {
  breakObj: AppBreakPoint = AppStorageV2.connect(AppBreakPoint, () => new AppBreakPoint())!
  // è½®æ’­å›¾
  // è½®æ’­å›¾
  @Local
  banners: Banner[] = []
  // åˆ†ç±»
  @Local
  categories: CategoryItem[] = []
  // ç‰¹æƒ æ¨è
  @Local
  saleGoods: HDMGoodsItem[] = []
  // çˆ†æ¬¾æ¨è
  @Local
  hotGoods: HDMGoodsItem[] = []
  // ä¸€ç«™ä¹°å…¨
  @Local
  oneGoods: HDMGoodsItem[] = []
  // æ–°é²œå¥½ç‰©
  @Local
  newGoods: HDMGoodsItem[] = []
  @Local
  recommendGoods: HDMGoodsItem[] = []

  // ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
  mockData() {
    this.banners = new Array(6).fill({
      id: "42",
      imgUrl: "https://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/meikou/banner/nuandong_sj.png",
      hrefUrl: "/category/1181622006",
      type: "1"
    })

    this.categories = new Array(10).fill({
      id: "1181622001",
      name: "æ°”è´¨å¥³è£…",
      picture: "https://yjy-teach-oss.oss-cn-beijing.aliyuncs.com/meikou/c1/qznz.png"
    })

    this.saleGoods = new Array(6).fill({
      "id": "1111002",
      "name": "å‰ªå‡ºç²¾è‡´æ„Ÿï¼Œé‡‘è‡´åœ†æŸ„å¤å¤å‰ªåˆ€",
      "desc": "è½»è–„è®¾è®¡ï¼Œç®€çº¦å¤§æ–¹",
      "price": "9.90",
      "picture": "https://yanxuan-item.nosdn.127.net/4c6a9c8a579b00e5e9c7b002d15a33a2.jpg",
      "orderNum": 172
    },)

    this.hotGoods = new Array(8).fill({
      "id": "1135059",
      "name": "æ‰‹å·¥å…«å¹´è€é™ˆé†‹500æ¯«å‡",
      "desc": "åœ°é“é†‡é¦™ï¼Œé†‹é…¸æµ“éƒ",
      "price": "30.00",
      "picture": "https://yanxuan-item.nosdn.127.net/77da20e77b02830a26f931901ac1a9e0.png",
      "orderNum": 147
    },)
    this.oneGoods = new Array(8).fill({
      "id": "1135079",
      "name": "å…æµ¸æ³¡ï¼Œ12ç§è°·ç‰©ä¸€æ¬¡åŒäº«ï¼Œäº”è°·ç±³400å…‹",
      "desc": "æ— éœ€æµ¸æ³¡ï¼ŒåŒç…®åŒç†Ÿ",
      "price": "9.90",
      "picture": "https://yanxuan-item.nosdn.127.net/bfe70bd66efe94f2f18061c707d2a097.png",
      "orderNum": 144
    })
    this.newGoods = new Array(8).fill({
      "id": "4027998",
      "name": "äº®ç¢Ÿå¤šæ•ˆåˆä¸€æ´—æ¶¤å—495g",
      "desc": "æ´—ç¢—æœºä¸“ç”¨ï¼Œå¼ºåŠ›å»æ±¡",
      "price": "69.90",
      "picture": "https://yanxuan-item.nosdn.127.net/e07c2b63765cf9f4a46d489c6e09c1c1.jpg",
      "orderNum": 643
    })

    this.recommendGoods = new Array(8).fill({
      "id": "4033959",
      "name": "3ç§’å¿«é€Ÿæ‹†ç´è½»æ¾ä¿å…»odinå¥¥ä¸12åŠéŸ³é˜¶å£ç´",
      "price": 329,
      "picture": "https://yanxuan-item.nosdn.127.net/937a8e46a9284e8f7e00e13911ecfbe7.png",
      "payCount": 0
    })
  }

  aboutToAppear(): void {
    // mockæ•°æ®
    this.mockData()

  }

  @Builder
  DiscountBuilder(params: Params) {

    Column() {
      Row({ space: 10 }) {
        Text(params.title)
          .fontColor($r('[basic].color.black'))
          .fontSize(14)
        Text(params.subTitle)
          .fontColor($r('[basic].color.text'))
          .fontSize(11)
      }
      .width('100%')
      .margin({ bottom: 10 })

      List({ space: 10 }) {
        ForEach(params.list, (item: HDMGoodsItem) => {
          ListItem() {
            HDMDiscountGoods({ type: DiscountType.DISCOUNT, goods: item })
          }
        })
      }
      .width('100%')
      .height(116)
      .scrollBar(BarState.Off)
      .listDirection(Axis.Horizontal)
    }
    .height(160)
    .layoutWeight(1)
    .padding(10)
    .backgroundColor(params.bg)
    .borderRadius(8)
  }

  build() {
    Scroll() {
      Column() {
        // è½®æ’­å›¾ + æœç´¢
        Stack({ alignContent: Alignment.Top }) {
          Swiper() {
            ForEach(this.banners, (item: Banner) => {
              Image(item.imgUrl)
            })
          }
          .displayCount(new BreakPointType({
            sm: 1,
            md: 2,
            lg: 3
          }).getValue(this.breakObj.breakPoint))
          .itemSpace(new BreakPointType({
            sm: 0,
            md: 10,
            lg: 20
          }).getValue(this.breakObj.breakPoint))
          .indicator(
            this.breakObj.breakPoint === BreakPointEnum.SM ?
            DotIndicator.dot()
              .itemWidth(8)
              .itemHeight(4)
              .color('#33191919')
              .selectedItemWidth(24)
              .selectedItemHeight(4)
              .selectedColor('#191919') : false
          )

          Row() {
            Row({ space: 4 }) {
              Image($r('[basic].media.ic_public_search'))
                .width(16)
                .height(16)
                .fillColor($r('[basic].color.white'))
              Text('æœç´¢...')
                .fontSize(14)
                .fontColor($r('[basic].color.white'))
            }
            .backgroundColor('#33191919')
            .width('100%')
            .height(40)
            .borderRadius(20)
            .padding({ left: 12 })
          }
          .padding({ left: 16, right: 16 })
        }
        .width('100%')


        // åˆ†ç±»
        Column({ space: 10 }) {
          // åˆ†ç±»
          List({
            space: new BreakPointType({
              sm: 14,
              md: 36,
              lg: 72
            }).getValue(this.breakObj.breakPoint)
          }) {
            ForEach(this.categories, (item: CategoryItem) => {
              ListItem() {
                Column() {
                  Image(item.picture)
                    .width(56)
                    .aspectRatio(1)
                  Text(item.name)
                    .fontSize(10)
                    .fontColor('#CC191919')
                }
                .width(60)
                .height(80)
                .borderRadius(30)

                .clip(true)
                .backgroundImage(item.picture)
                .backgroundImageSize(ImageSize.Contain)
                .backgroundImagePosition(Alignment.Center)
                .backgroundBlurStyle(
                  BlurStyle.BACKGROUND_ULTRA_THICK,
                  { scale: 0.25 }
                )
              }
            })
          }
          .width('100%')
          .height(92)
          .scrollBar(BarState.Off)
          .listDirection(Axis.Horizontal)
          .alignListItem(ListItemAlign.Center)

          // ç‰¹æƒ æ¨è
          Column({ space: 10 }) {
            Image($r('app.media.home_cmd_title'))
              .width(150)
              .height(20)
            Row() {
              Image($r('app.media.home_cmd_inner'))
                .width(86)
                .height(116)
              List({ space: 10 }) {
                ForEach(this.saleGoods, (item: HDMGoodsItem) => {
                  ListItem() {
                    HDMDiscountGoods({ goods: item })
                  }
                })
              }
              .layoutWeight(1)
              .width('100%')
              .height(116)
              .backgroundColor($r('[basic].color.white'))
              .borderRadius({
                topRight: 8,
                bottomRight: 8
              })
              .padding({ right: 10, left: 10 })
              .scrollBar(BarState.Off)
              .listDirection(Axis.Horizontal)
            }
          }
          .width('100%')
          .height(166)
          .backgroundImage($r('app.media.home_cmd_sm'))
          .backgroundImageSize(ImageSize.Cover)
          .borderRadius(8)
          .padding(10)
          .alignItems(HorizontalAlign.Start)

          // çˆ†æ¬¾æ¨è+ä¸€ç«™ä¹°å…¨
          Row({ space: 10 }) {
            this.DiscountBuilder({
              title: 'çˆ†æ¬¾æ¨è',
              subTitle: 'æœ€å—æ¬¢è¿',
              bg: '#EDF1FB',
              list: this.hotGoods
            })
            this.DiscountBuilder({
              title: 'ä¸€ç«™ä¹°å…¨',
              subTitle: 'ç²¾å¿ƒä¼˜é€‰',
              bg: '#FCF6EA',
              list: this.oneGoods
            })
          }

          // æ–°é²œå¥½ç‰©
          Column({ space: 10 }) {
            Image($r('app.media.home_new'))
              .width(146)
              .height(19)
            List({
              space: new BreakPointType({
                sm: 14,
                md: 36,
                lg: 72
              }).getValue(this.breakObj.breakPoint)
            }) {
              ForEach(this.newGoods, (item: HDMGoodsItem) => {
                ListItem() {
                  HDMDiscountGoods({ type: DiscountType.NEW, goods: item })
                }
              })
            }
            .width('100%')
            .height(116)
            .scrollBar(BarState.Off)
            .listDirection(Axis.Horizontal)
          }
          .width('100%')
          .height(156)
          .padding(10)
          .backgroundColor('#F7EFF5')
          .borderRadius(8)
          .alignItems(HorizontalAlign.Start)

          // æ¨èå•†å“
          WaterFlow() {
            ForEach(this.recommendGoods, (item: HDMGoodsItem) => {
              FlowItem() {
                HDMGoods({ goods: item })
              }
            })
          }
          .columnsTemplate(new BreakPointType({
            sm: "1fr 1fr",
            md: "1fr 1fr 1fr",
            lg: "1fr 1fr 1fr 1fr"
          }).getValue(this.breakObj.breakPoint))
          .columnsGap(8)
          .rowsGap(10)

        }
        .padding({
          left: 8,
          right: 8,
          bottom: 10,
          top: 10
        })
      }
    }
    .scrollBar(BarState.Off)
  }
}
```

![img](https://cdn.nlark.com/yuque/0/2025/png/8435673/1743044288152-ad1df2e4-2b67-478d-9c94-ecdbe0f70984.png)

- å¹³æ¿å»é™¤åˆ‡æ¢åŠ¨ç”»

```typescript
import { AppBreakPoint, BreakPointType, TabItem } from 'basic'
import { CartView } from 'cart'
import { CategoryView } from 'category'
import { HomeView } from 'home'
import { MineView } from 'mine'
import { AppStorageV2 } from '@kit.ArkUI'

@Entry
@ComponentV2
struct Index {
  breakObj: AppBreakPoint = AppStorageV2.connect(AppBreakPoint, () => new AppBreakPoint())!
  @Local
  activeIndex: number = 0
  list: TabItem[] = [
    { text: 'é¦–é¡µ', normal: $r('app.media.ic_public_home_normal'), active: $r('app.media.ic_public_home_active') },
    { text: 'åˆ†ç±»', normal: $r('app.media.ic_public_pro_normal'), active: $r('app.media.ic_public_pro_active') },
    { text: 'è´­ç‰©è¢‹', normal: $r('app.media.ic_public_cart_normal'), active: $r('app.media.ic_public_cart_active') },
    { text: 'æˆ‘çš„', normal: $r('app.media.ic_public_my_normal'), active: $r('app.media.ic_public_my_active') },
  ]

  @Builder
  getTabItemBuilder(item: TabItem, index: number) {
    Column() {
      Image(this.activeIndex === index ? item.active : item.normal)
        .width(24)
        .aspectRatio(1)
      Text(item.text)// è·¨ HSP è®¿é—®èµ„æºï¼Œéœ€è¦åœ¨ oh-package.json5ä¸­å¯¼å…¥
        .fontColor($r("[basic].color.black"))
        .fontSize(12)
    }
    .justifyContent(FlexAlign.SpaceEvenly)
    .height(50)
  }

  build() {
    Tabs({
      barPosition: new BreakPointType({
        sm: BarPosition.End,
        md: BarPosition.End,
        lg: BarPosition.Start
      }).getValue(this.breakObj.breakPoint), index: $$this.activeIndex
    }) {
      ForEach(this.list, (item: TabItem, index: number) => {
        TabContent() {
          if (index === 0) {
            HomeView()
          } else if (index === 1) {
            CategoryView()
          } else if (index === 2) {
            CartView()
          } else {
            MineView()
          }
        }
        .tabBar(this.getTabItemBuilder(item, index))
      })
    }
    .barHeight(new BreakPointType({
      sm: 60,
      md: 60,
      lg: 220
    }).getValue(this.breakObj.breakPoint))
    .vertical(new BreakPointType({
      sm: false,
      md: false,
      lg: true
    }).getValue(this.breakObj.breakPoint))
    .scrollable(false)
    .animationDuration(new BreakPointType({
      sm: 300,
      md: 300,
      lg: 0
    }).getValue(this.breakObj.breakPoint))
  }
}
```





### 1.2.3. æ²‰æµ¸å¼å¯¼èˆª

æ¥ä¸‹æ¥å®Œæˆæ²‰æµ¸å¼å¯¼èˆª

[deviceinfo](https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/js-apis-device-info-V5)

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1717429649856-21153adc-97a0-4171-8d35-7980da7feea7.png)

![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1724137444194-607e53a0-b23b-43a0-8967-3d768a4c41e5.png)![img](https://cdn.nlark.com/yuque/0/2024/png/639379/1724137519869-422e3b0b-02ae-44df-99a5-1cbb2f82d953.png)

**éœ€æ±‚ï¼š**

1. é 2in1 æ¨¡å¼ä¸‹å¼€å¯æ²‰æµ¸å¼å¯¼èˆª
2. è®¾ç½®é¡¶éƒ¨å®‰å…¨åŒºåŸŸï¼ˆhomeï¼‰åŠåº•éƒ¨å®‰å…¨åŒºåŸŸï¼ˆtabsï¼‰

| **è®¾å¤‡ç±»å‹** | **æšä¸¾å€¼** | **è¯´æ˜**                             |
| ------------ | ---------- | ------------------------------------ |
| æ‰‹æœº         | phone      | -                                    |
| å¹³æ¿         | tablet     | -                                    |
| 2in1è®¾å¤‡     | 2in1       | -                                    |
| æ™ºæ…§å±       | tv         | -                                    |
| æ™ºèƒ½æ‰‹è¡¨     | wearable   | ç³»ç»Ÿèƒ½åŠ›è¾ƒä¸°å¯Œçš„æ‰‹è¡¨ï¼Œå…·å¤‡ç”µè¯åŠŸèƒ½ã€‚ |
| è½¦æœº         | car        | -                                    |

**æ ¸å¿ƒæ­¥éª¤ï¼š**

- æ²¿ç”¨äº†å°æ—¶è¾¾é¡¹ç›®çš„æ²‰æµ¸å¼å¯¼èˆªçš„æ–¹æ³•-åŠ å…¥ä¸€ä¸ªåˆ¤æ–­æ˜¯å¦ä¸ºç”µè„‘è®¾å¤‡
- åœ¨abilityä¸­è°ƒç”¨å®ç°æ²‰æµ¸å¼å…¨å±
- å®šä¹‰ä¸€ä¸ªå…¨å±€ç¼“å­˜å®‰å…¨åŒºé«˜åº¦çš„å¯¹è±¡

```typescript
commons/basic/src/main/ets/viewmodels/common.ets

// å­˜å‚¨å½“å‰å…¨å±€å®‰å…¨åŒºçš„å¯¹è±¡
@ObservedV2
export class AppSafeArea {
  @Trace
  topHeight: number = 0
  @Trace
  bottomHeight: number = 0
}
```

- commons/basic/utils/ScreenManager.ets

```ts
import { Context } from "@kit.AbilityKit"
import { AppStorageV2, display, window } from "@kit.ArkUI"
import { AppBreakPoint, AppSafeArea, BreakPointEnum } from "../viewmodels"
import { deviceInfo } from "@kit.BasicServicesKit"

export class ScreenManager {
  ctx?: Context

  // æ³¨å†Œå±å¹•å®½åº¦å˜åŒ–
  async registerWindowSizeChange() {
    const win = await this.getWin() // è·å–windowå¯¹è±¡
    this.judgeScreen(px2vp(display.getDefaultDisplaySync().width)) // ç¬¬ä¸€æ¬¡æ‰‹åŠ¨åˆ¤æ–­ä¸€æ¬¡
    win.on("windowSizeChange", (size) => {
      this.judgeScreen(px2vp(size.width)) // vpåŒºé—´
    })
  }

  // åˆ¤æ–­å±å¹•
  judgeScreen(width: number) {
    let breakPoint: BreakPointEnum = BreakPointEnum.XS
    if (width > 0 && width < 320) {
      breakPoint = BreakPointEnum.XS
    } else if (width >= 320 && width < 520) {
      breakPoint = BreakPointEnum.SM
    } else if (width >= 520 && width < 840) {
      breakPoint = BreakPointEnum.MD
    } else {
      breakPoint = BreakPointEnum.LG
    }
    //   V1 AppStorage.setOrCreate("key", "value")
    const app = AppStorageV2.connect(AppBreakPoint, () => new AppBreakPoint())!
    app.breakPoint = breakPoint // å°†æ–­ç‚¹å€¼å­˜å…¥åˆ°å…¨å±€çŠ¶æ€
  }

  // å–æ¶ˆæ³¨å†Œ
  async unRegisterWindowSizeChange() {
    const win = await this.getWin() // è·å–windowå¯¹è±¡
    win.off("windowSizeChange") // å¸è½½ç›‘å¬
  }

  // å…¨å±
  async full() {
    const win = await this.getWin()
    win.setWindowLayoutFullScreen(true)
    this.setAreaHeight(deviceInfo.deviceType === "2in1" ? 0 :
    px2vp(win.getWindowAvoidArea(window.AvoidAreaType.TYPE_SYSTEM).topRect.height),
      px2vp(deviceInfo.deviceType === "2in1" ? 0 :
      win.getWindowAvoidArea(window.AvoidAreaType.TYPE_NAVIGATION_INDICATOR).bottomRect.height))
    // é¡¶éƒ¨å®‰å…¨åŒºé«˜åº¦
    // åº•éƒ¨å®‰å…¨åŒºé«˜åº¦
  }

  // é€€å‡ºå…¨å±
  async exitFull() {
    const win = await this.getWin()
    win.setWindowLayoutFullScreen(false)
    this.setAreaHeight(0, 0)
  }

  // è®¾ç½®å®‰å…¨åŒºé«˜åº¦
  setAreaHeight(top: number, bottom: number) {
    const app = AppStorageV2.connect(AppSafeArea, () => new AppSafeArea())!
    app.topHeight = top
    app.bottomHeight = bottom
  }

  getWin() {
    return window.getLastWindow(this.ctx || getContext())
  }
}

export const screenManager = new ScreenManager()
```

- åœ¨phoneçš„abilityä¸­å®ç°å…¨å±

```ts
products/phone/src/main/ets/entryability/EntryAbility.ets

onWindowStageCreate(windowStage: window.WindowStage): void {
    // Main window is created, set main page for this ability
    hilog.info(DOMAIN, 'testTag', '%{public}s', 'Ability onWindowStageCreate');
    screenManager.ctx = this.context
    screenManager.registerWindowSizeChange() // æ³¨å†Œå±å¹•å˜åŒ–
    screenManager.full() // å®ç°æ²‰æµ¸å¼å…¨å±
    windowStage.loadContent('pages/Index', (err) => {
      if (err.code) {
        hilog.error(DOMAIN, 'testTag', 'Failed to load the content. Cause: %{public}s', JSON.stringify(err));
        return;
      }
      hilog.info(DOMAIN, 'testTag', 'Succeeded in loading the content.');
    });
  }
```

- å®ç°é¡¶éƒ¨è·ç¦»çš„å®‰å…¨åŒºé¿è®©

  ```ts
  features/home/src/main/ets/views/HomeView/HomeView.ets
    safeArea: AppSafeArea = AppStorageV2.connect(AppSafeArea, () => new AppSafeArea())!
  
  ```

  

```ts
          Row() {
            Row({ space: 4 }) {
              Image($r('[basic].media.ic_public_search'))
                .width(16)
                .height(16)
                .fillColor($r('[basic].color.white'))
              Text('æœç´¢...')
                .fontSize(14)
                .fontColor($r('[basic].color.white'))
            }
            .backgroundColor('#33191919')
            .width('100%')
            .height(40)
            .borderRadius(20)
            .padding({ left: 12 })
          }
          .padding({
            left: 16,
            right: 16,
            top:  this.safeArea.topHeight
          })
```

- Indexé¡µé¢å¤„ç†åº•éƒ¨å®‰å…¨åŒº

```ts
products/phone/src/main/ets/pages/Index.ets

safeArea: AppSafeArea = AppStorageV2.connect(AppSafeArea, () => new AppSafeArea())!

 .padding({
      bottom: this.safeArea.bottomHeight
    })
```

![img](https://cdn.nlark.com/yuque/0/2025/png/8435673/1743045816038-1f417dc3-eb92-4c5a-844a-ef8c31eab5c7.png)



